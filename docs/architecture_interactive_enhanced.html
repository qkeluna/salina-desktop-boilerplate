<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Local-First Desktop App Architecture vs Micro Frontend Architecture</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js" onerror="loadChartJSFallback()"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js" onerror="loadD3Fallback()"></script>
    <script>
        // Fallback CDN loaders
        function loadChartJSFallback() {
            console.warn('Primary Chart.js CDN failed, loading fallback...');
            const script = document.createElement('script');
            script.src = 'https://unpkg.com/chart.js@4.4.0/dist/chart.umd.min.js';
            script.onload = () => console.log('Chart.js loaded from fallback CDN');
            document.head.appendChild(script);
        }
        
        function loadD3Fallback() {
            console.warn('Primary d3.js CDN failed, loading fallback...');
            const script = document.createElement('script');
            script.src = 'https://unpkg.com/d3@7.8.5/dist/d3.min.js';
            script.onload = () => console.log('d3.js loaded from fallback CDN');
            document.head.appendChild(script);
        }
    </script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1e40af',
                        secondary: '#64748b',
                        accent: '#3b82f6',
                        dark: '#1e293b',
                        light: '#f8fafc'
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-in': 'slideIn 0.3s ease-out',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideIn {
            from { transform: translateY(-10px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .progress-bar {
            transition: width 0.3s ease;
        }
        .search-highlight {
            background-color: rgba(59, 130, 246, 0.3);
            transition: background-color 0.3s ease;
        }
        .nav-link {
            transition: all 0.2s ease;
        }
        .nav-link:hover {
            transform: translateX(4px);
        }
        .table-row:hover {
            background-color: rgba(59, 130, 246, 0.05);
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -8px;
            top: 8px;
            width: 16px;
            height: 16px;
            background: #3b82f6;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 0 0 2px #3b82f6;
        }
        .comparison-table {
            border-collapse: separate;
            border-spacing: 0;
        }
        .comparison-table th,
        .comparison-table td {
            border: 1px solid #e2e8f0;
            padding: 12px 16px;
        }
        .comparison-table th:first-child {
            border-top-left-radius: 8px;
        }
        .comparison-table th:last-child {
            border-top-right-radius: 8px;
        }
        .comparison-table tr:last-child td:first-child {
            border-bottom-left-radius: 8px;
        }
        .comparison-table tr:last-child td:last-child {
            border-bottom-right-radius: 8px;
        }
        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-in-out;
        }
        .collapsible-content.expanded {
            max-height: 2000px;
        }
        .collapsible-header {
            cursor: pointer;
            user-select: none;
        }
        .architecture-node {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .architecture-node:hover {
            filter: brightness(1.1);
            transform: scale(1.05);
        }
        .chart-container {
            position: relative;
            height: 400px;
        }
        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 12px;
            pointer-events: none;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .tooltip.show {
            opacity: 1;
        }
    </style>
</head>
<body class="bg-light text-dark font-sans">
    <!-- Search Modal -->
    <div id="search-modal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black bg-opacity-50" onclick="toggleSearch()"></div>
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full p-6">
                <div class="flex items-center space-x-4 mb-4">
                    <svg class="w-6 h-6 text-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                    <input type="text" id="search-input" placeholder="Search documentation..." class="flex-1 text-lg border-0 focus:outline-none">
                </div>
                <div id="search-results" class="max-h-64 overflow-y-auto"></div>
            </div>
        </div>
    </div>

    <!-- Communication Details Modal -->
    <div id="communication-modal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black bg-opacity-50"></div>
        <div class="relative flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full p-6 animate-fade-in relative z-10">
                <div class="flex items-center justify-between mb-4">
                    <h3 id="communication-modal-title" class="text-2xl font-bold text-primary">Communication Pattern Details</h3>
                    <button onclick="closeCommunicationModal()" class="text-gray-400 hover:text-gray-600 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                <div class="mb-6">
                    <div id="communication-modal-icon" class="w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4"></div>
                    <p id="communication-modal-content" class="text-gray-700 leading-relaxed text-center px-4"></p>
                </div>
                <div class="flex justify-end">
                    <button onclick="closeCommunicationModal()" class="px-6 py-2 bg-primary text-white rounded-lg hover:bg-opacity-90 transition-colors">
                        Got it
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="flex min-h-screen">
        <!-- Sidebar Navigation -->
        <aside id="sidebar" class="fixed inset-y-0 left-0 z-40 w-80 bg-white shadow-lg transform -translate-x-full transition-transform duration-300 ease-in-out lg:translate-x-0 lg:sticky lg:top-0 lg:h-screen">
            <div class="flex flex-col h-full overflow-y-auto">
                <div class="flex items-center justify-between p-6 border-b">
                    <h2 class="text-lg font-semibold text-dark">Navigation</h2>
                    <button id="close-sidebar" class="lg:hidden text-secondary hover:text-dark">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                <div class="flex-1 overflow-y-auto p-6">
                    <div class="mb-6">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm font-medium text-secondary">Reading Progress</span>
                            <span id="progress-percentage" class="text-sm font-medium text-primary">0%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div id="progress-bar" class="bg-primary h-2 rounded-full progress-bar" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <nav class="space-y-2">
                        <div class="nav-section">
                            <h3 class="text-sm font-semibold text-secondary uppercase tracking-wider mb-2">Overview</h3>
                            <a href="#executive-summary" class="nav-link block py-2 px-3 rounded-md text-dark hover:bg-accent hover:text-white">Executive Summary</a>
                        </div>
                        
                        <div class="nav-section">
                            <h3 class="text-sm font-semibold text-secondary uppercase tracking-wider mb-2">Part 1: Current Architecture</h3>
                            <a href="#current-architecture" class="nav-link block py-2 px-3 rounded-md text-dark hover:bg-accent hover:text-white">Architecture Overview</a>
                            <a href="#tech-stack" class="nav-link block py-2 px-3 rounded-md text-dark hover:bg-accent hover:text-white">Technology Stack</a>
                            <a href="#deployment-patterns" class="nav-link block py-2 px-3 rounded-md text-dark hover:bg-accent hover:text-white">Deployment Patterns</a>
                            <a href="#strengths-limitations" class="nav-link block py-2 px-3 rounded-md text-dark hover:bg-accent hover:text-white">Strengths & Limitations</a>
                        </div>
                        
                        <div class="nav-section">
                            <h3 class="text-sm font-semibold text-secondary uppercase tracking-wider mb-2">Part 2: Detailed Analysis</h3>
                            <a href="#micro-frontend-overview" class="nav-link block py-2 px-3 rounded-md text-dark hover:bg-accent hover:text-white">MFE Architecture</a>
                            <a href="#repository-analysis" class="nav-link block py-2 px-3 rounded-md text-dark hover:bg-accent hover:text-white">Repository Deep Dives</a>
                            <a href="#communication-patterns" class="nav-link block py-2 px-3 rounded-md text-dark hover:bg-accent hover:text-white">Communication Patterns</a>
                        </div>
                        
                        <div class="nav-section">
                            <h3 class="text-sm font-semibold text-secondary uppercase tracking-wider mb-2">Part 3: Comparison</h3>
                            <a href="#architecture-comparison" class="nav-link block py-2 px-3 rounded-md text-dark hover:bg-accent hover:text-white">Architecture Comparison</a>
                            <a href="#performance-analysis" class="nav-link block py-2 px-3 rounded-md text-dark hover:bg-accent hover:text-white">Performance Analysis</a>
                        </div>
                        
                        <div class="nav-section">
                            <h3 class="text-sm font-semibold text-secondary uppercase tracking-wider mb-2">Part 4: Migration Strategy</h3>
                            <a href="#migration-timeline" class="nav-link block py-2 px-3 rounded-md text-dark hover:bg-accent hover:text-white">Migration Timeline</a>
                            <a href="#migration-phases" class="nav-link block py-2 px-3 rounded-md text-dark hover:bg-accent hover:text-white">Migration Phases</a>
                        </div>
                        
                        <div class="nav-section">
                            <h3 class="text-sm font-semibold text-secondary uppercase tracking-wider mb-2">Part 5: Technical Specs</h3>
                            <a href="#technical-architecture" class="nav-link block py-2 px-3 rounded-md text-dark hover:bg-accent hover:text-white">Technical Architecture</a>
                            <a href="#recommendations" class="nav-link block py-2 px-3 rounded-md text-dark hover:bg-accent hover:text-white">Recommendations</a>
                        </div>
                    </nav>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 lg:ml-0">
            <!-- Mobile menu button -->
            <div class="lg:hidden fixed top-4 left-4 z-30">
                <button id="mobile-menu-btn" class="bg-white p-2 rounded-md shadow-md text-secondary hover:text-dark">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>

            <!-- Hero Section -->
            <section class="gradient-bg text-white py-20 lg:py-32">
                <div class="container mx-auto px-6 text-center">
                    <h1 class="text-4xl lg:text-6xl font-bold mb-6 animate-fade-in">
                        Local-First Desktop App Architecture
                    </h1>
                    <h2 class="text-2xl lg:text-4xl font-light mb-8 animate-fade-in">
                        vs Micro Frontend Architecture
                    </h2>
                    <p class="text-xl lg:text-2xl mb-12 max-w-4xl mx-auto animate-slide-in">
                        Comprehensive technical analysis of the Salina Unified UI Platform architecture transformation
                    </p>
                    <div class="flex flex-col sm:flex-row gap-4 justify-center animate-slide-in">
                        <button onclick="scrollToSection('executive-summary')" class="bg-white text-primary px-8 py-4 rounded-lg font-semibold hover:bg-gray-100 transition-colors">
                            Explore Analysis
                        </button>
                        <button onclick="scrollToSection('architecture-comparison')" class="border-2 border-white text-white px-8 py-4 rounded-lg font-semibold hover:bg-white hover:text-primary transition-colors">
                            View Comparison
                        </button>
                    </div>
                </div>
            </section>

            <!-- Executive Summary -->
            <section id="executive-summary" class="py-16 bg-white">
                <div class="container mx-auto px-6">
                    <div class="max-w-4xl mx-auto">
                        <div class="mb-8">
                            <h2 class="text-3xl lg:text-4xl font-bold">Executive Summary</h2>
                        </div>
                        <div class="grid md:grid-cols-2 gap-8">
                            <div class="bg-light p-8 rounded-lg card-hover">
                                <h3 class="text-xl font-semibold mb-4 text-primary">Current State</h3>
                                <p class="text-secondary mb-4">The Salina platform is built on a sophisticated micro-frontend architecture with 6 distinct repositories managed by a central Shell application.</p>
                                <div class="text-sm text-secondary">
                                    <div class="flex items-center mb-2">
                                        <div class="w-3 h-3 bg-blue-500 rounded-full mr-2"></div>
                                        React 18.2.0 + TypeScript
                                    </div>
                                    <div class="flex items-center mb-2">
                                        <div class="w-3 h-3 bg-green-500 rounded-full mr-2"></div>
                                        Zustand State Management
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-3 h-3 bg-purple-500 rounded-full mr-2"></div>
                                        Vite Build System
                                    </div>
                                </div>
                            </div>
                            <div class="bg-light p-8 rounded-lg card-hover">
                                <h3 class="text-xl font-semibold mb-4 text-primary">Proposed Direction</h3>
                                <p class="text-secondary mb-4">Local-first desktop application architecture for enhanced performance, offline capabilities, and improved user privacy.</p>
                                <div class="text-sm text-secondary">
                                    <div class="flex items-center mb-2">
                                        <div class="w-3 h-3 bg-orange-500 rounded-full mr-2"></div>
                                        Offline-First Design
                                    </div>
                                    <div class="flex items-center mb-2">
                                        <div class="w-3 h-3 bg-red-500 rounded-full mr-2"></div>
                                        Local Data Storage
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-3 h-3 bg-indigo-500 rounded-full mr-2"></div>
                                        Desktop Optimization
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Part 1: Current Architecture -->
            <section id="current-architecture" class="py-16 bg-gray-50">
                <div class="container mx-auto px-6">
                    <div class="max-w-6xl mx-auto">
                        <div class="mb-8">
                            <h2 class="text-3xl lg:text-4xl font-bold text-center">Part 1: Current Architecture Analysis</h2>
                        </div>
                        
                        <!-- Architecture Overview with Interactive Diagram -->
                        <div class="bg-white rounded-lg shadow-lg p-8 mb-8 card-hover">
                            <div class="mb-6">
                                <h3 id="architecture-overview" class="text-2xl font-semibold">Micro Frontend Architecture Overview</h3>
                            </div>
                            <div class="grid lg:grid-cols-2 gap-8">
                                <div>
                                    <h4 class="text-lg font-semibold mb-4">System Components</h4>
                                    <div class="space-y-3">
                                        <div class="flex items-center p-3 bg-light rounded-lg">
                                            <div class="w-4 h-4 bg-primary rounded-full mr-3"></div>
                                            <div>
                                                <div class="font-medium">Shell Application</div>
                                                <div class="text-sm text-secondary">Central container & routing</div>
                                            </div>
                                        </div>
                                        <div class="flex items-center p-3 bg-light rounded-lg">
                                            <div class="w-4 h-4 bg-accent rounded-full mr-3"></div>
                                            <div>
                                                <div class="font-medium">Home Module</div>
                                                <div class="text-sm text-secondary">Dashboard & landing page</div>
                                            </div>
                                        </div>
                                        <div class="flex items-center p-3 bg-light rounded-lg">
                                            <div class="w-4 h-4 bg-green-500 rounded-full mr-3"></div>
                                            <div>
                                                <div class="font-medium">Search & Chat</div>
                                                <div class="text-sm text-secondary">AI-powered search interface</div>
                                            </div>
                                        </div>
                                        <div class="flex items-center p-3 bg-light rounded-lg">
                                            <div class="w-4 h-4 bg-purple-500 rounded-full mr-3"></div>
                                            <div>
                                                <div class="font-medium">Transcriptions</div>
                                                <div class="text-sm text-secondary">Video/audio transcription service</div>
                                            </div>
                                        </div>
                                        <div class="flex items-center p-3 bg-light rounded-lg">
                                            <div class="w-4 h-4 bg-orange-500 rounded-full mr-3"></div>
                                            <div>
                                                <div class="font-medium">Notes</div>
                                                <div class="text-sm text-secondary">Rich text editor</div>
                                            </div>
                                        </div>
                                        <div class="flex items-center p-3 bg-light rounded-lg">
                                            <div class="w-4 h-4 bg-red-500 rounded-full mr-3"></div>
                                            <div>
                                                <div class="font-medium">Files</div>
                                                <div class="text-sm text-secondary">File management system</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="bg-light p-6 rounded-lg">
                                    <h4 class="text-lg font-semibold mb-4">Interactive Architecture Diagram</h4>
                                    <div class="bg-white p-4 rounded border-2 border-dashed border-gray-300 min-h-[300px] relative">
                                        <div id="architecture-diagram"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Technology Stack with Interactive Chart -->
                        <div id="tech-stack" class="bg-white rounded-lg shadow-lg p-8 mb-8 card-hover">
                            <div class="mb-6">
                                <h3 class="text-2xl font-semibold">Technology Stack Analysis</h3>
                            </div>
                            <div class="grid lg:grid-cols-2 gap-8">
                                <div class="space-y-4">
                                    <h4 class="text-lg font-semibold text-primary">Tech Stack Distribution</h4>
                                    <div class="chart-container" style="position: relative; height: 400px; width: 100%;">
                                        <canvas id="techStackChart" style="max-width: 100%; height: 100%;"></canvas>
                                    </div>
                                </div>
                                <div class="space-y-4">
                                    <h4 class="text-lg font-semibold text-primary">Component Breakdown</h4>
                                    <div class="grid grid-cols-1 gap-4">
                                        <div class="bg-light p-4 rounded-lg">
                                            <div class="flex justify-between items-center mb-2">
                                                <span class="font-medium">Frontend Framework</span>
                                                <span class="text-sm text-primary">100%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 rounded-full h-2">
                                                <div class="bg-primary h-2 rounded-full" style="width: 100%"></div>
                                            </div>
                                        </div>
                                        <div class="bg-light p-4 rounded-lg">
                                            <div class="flex justify-between items-center mb-2">
                                                <span class="font-medium">State Management</span>
                                                <span class="text-sm text-accent">100%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 rounded-full h-2">
                                                <div class="bg-accent h-2 rounded-full" style="width: 100%"></div>
                                            </div>
                                        </div>
                                        <div class="bg-light p-4 rounded-lg">
                                            <div class="flex justify-between items-center mb-2">
                                                <span class="font-medium">Build Tool</span>
                                                <span class="text-sm text-green-500">100%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 rounded-full h-2">
                                                <div class="bg-green-500 h-2 rounded-full" style="width: 100%"></div>
                                            </div>
                                        </div>
                                        <div class="bg-light p-4 rounded-lg">
                                            <div class="flex justify-between items-center mb-2">
                                                <span class="font-medium">UI Framework</span>
                                                <span class="text-sm text-purple-500">100%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 rounded-full h-2">
                                                <div class="bg-purple-500 h-2 rounded-full" style="width: 100%"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Collapsible Strengths and Limitations -->
                        <div id="strengths-limitations" class="bg-white rounded-lg shadow-lg card-hover">
                            <div class="collapsible-header p-8 flex items-center justify-between cursor-pointer" onclick="toggleCollapsible(this)">
                                    <h3 class="text-2xl font-semibold">Strengths & Limitations</h3>
                                <svg class="w-6 h-6 text-secondary transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                </svg>
                            </div>
                            <div class="collapsible-content">
                                <div class="px-8 pb-8">
                                    <div class="grid lg:grid-cols-2 gap-8">
                                        <div>
                                            <h4 class="text-lg font-semibold mb-4 text-green-600 flex items-center">
                                                <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                                                </svg>
                                                Strengths
                                            </h4>
                                            <div class="space-y-3">
                                                <div class="flex items-start p-3 bg-green-50 rounded-lg">
                                                    <div class="w-2 h-2 bg-green-500 rounded-full mt-2 mr-3 flex-shrink-0"></div>
                                                    <div>
                                                        <div class="font-medium">Scalability</div>
                                                        <div class="text-sm text-secondary">Independent scaling of each micro-frontend</div>
                                                    </div>
                                                </div>
                                                <div class="flex items-start p-3 bg-green-50 rounded-lg">
                                                    <div class="w-2 h-2 bg-green-500 rounded-full mt-2 mr-3 flex-shrink-0"></div>
                                                    <div>
                                                        <div class="font-medium">Team Agility</div>
                                                        <div class="text-sm text-secondary">Independent development and deployment cycles</div>
                                                    </div>
                                                </div>
                                                <div class="flex items-start p-3 bg-green-50 rounded-lg">
                                                    <div class="w-2 h-2 bg-green-500 rounded-full mt-2 mr-3 flex-shrink-0"></div>
                                                    <div>
                                                        <div class="font-medium">Technology Flexibility</div>
                                                        <div class="text-sm text-secondary">Can use different technologies per module</div>
                                                    </div>
                                                </div>
                                                <div class="flex items-start p-3 bg-green-50 rounded-lg">
                                                    <div class="w-2 h-2 bg-green-500 rounded-full mt-2 mr-3 flex-shrink-0"></div>
                                                    <div>
                                                        <div class="font-medium">System Resilience</div>
                                                        <div class="text-sm text-secondary">Failures isolated to individual modules</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div>
                                            <h4 class="text-lg font-semibold mb-4 text-red-600 flex items-center">
                                                <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
                                                </svg>
                                                Limitations
                                            </h4>
                                            <div class="space-y-3">
                                                <div class="flex items-start p-3 bg-red-50 rounded-lg">
                                                    <div class="w-2 h-2 bg-red-500 rounded-full mt-2 mr-3 flex-shrink-0"></div>
                                                    <div>
                                                        <div class="font-medium">Network Dependency</div>
                                                        <div class="text-sm text-secondary">Requires stable internet for all functionality</div>
                                                    </div>
                                                </div>
                                                <div class="flex items-start p-3 bg-red-50 rounded-lg">
                                                    <div class="w-2 h-2 bg-red-500 rounded-full mt-2 mr-3 flex-shrink-0"></div>
                                                    <div>
                                                        <div class="font-medium">Performance Issues</div>
                                                        <div class="text-sm text-secondary">High initial load times with multiple bundles</div>
                                                    </div>
                                                </div>
                                                <div class="flex items-start p-3 bg-red-50 rounded-lg">
                                                    <div class="w-2 h-2 bg-red-500 rounded-full mt-2 mr-3 flex-shrink-0"></div>
                                                    <div>
                                                        <div class="font-medium">Complexity</div>
                                                        <div class="text-sm text-secondary">Managing dependencies across repositories</div>
                                                    </div>
                                                </div>
                                                <div class="flex items-start p-3 bg-red-50 rounded-lg">
                                                    <div class="w-2 h-2 bg-red-500 rounded-full mt-2 mr-3 flex-shrink-0"></div>
                                                    <div>
                                                        <div class="font-medium">Offline Unavailability</div>
                                                        <div class="text-sm text-secondary">No offline functionality</div>
                                                    </div>
                                                </div>
                                                <div class="flex items-start p-3 bg-red-50 rounded-lg">
                                                    <div class="w-2 h-2 bg-red-500 rounded-full mt-2 mr-3 flex-shrink-0"></div>
                                                    <div>
                                                        <div class="font-medium">Data Privacy Concerns</div>
                                                        <div class="text-sm text-secondary">All data stored in cloud</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Part 2: Detailed Analysis -->
            <section id="micro-frontend-overview" class="py-16 bg-white">
                <div class="container mx-auto px-6">
                    <div class="max-w-6xl mx-auto">
                        <div class="mb-8">
                            <h2 class="text-3xl lg:text-4xl font-bold text-center">Part 2: Detailed Architecture Analysis</h2>
                        </div>
                        
                        <!-- Repository Deep Dives with Interactive Cards -->
                        <div id="repository-analysis" class="bg-white rounded-lg shadow-lg p-8 mb-8 card-hover">
                            <div class="mb-6">
                                <h3 class="text-2xl font-semibold">Individual Repository Analysis</h3>
                            </div>
                            <div class="grid lg:grid-cols-2 gap-8">
                                <div class="space-y-6">
                                    <div class="border-l-4 border-primary pl-4 hover:bg-light p-3 rounded transition-colors">
                                        <h4 class="text-lg font-semibold text-primary">Shell Application</h4>
                                        <p class="text-secondary mb-3">Foundation of the Salina platform</p>
                                        <ul class="text-sm space-y-1">
                                            <li>• Routing and authentication management</li>
                                            <li>• Global layout and navigation</li>
                                            <li>• State management via Zustand</li>
                                            <li>• Micro-frontend orchestration</li>
                                        </ul>
                                    </div>
                                    <div class="border-l-4 border-accent pl-4 hover:bg-light p-3 rounded transition-colors">
                                        <h4 class="text-lg font-semibold text-accent">Home Module</h4>
                                        <p class="text-secondary mb-3">Main dashboard and landing page</p>
                                        <ul class="text-sm space-y-1">
                                            <li>• Personalized user greeting</li>
                                            <li>• Quick access action cards</li>
                                            <li>• Central search interface</li>
                                            <li>• Onboarding experience</li>
                                        </ul>
                                    </div>
                                    <div class="border-l-4 border-green-500 pl-4 hover:bg-light p-3 rounded transition-colors">
                                        <h4 class="text-lg font-semibold text-green-600">Search & Chat</h4>
                                        <p class="text-secondary mb-3">AI-powered search and chat interface</p>
                                        <ul class="text-sm space-y-1">
                                            <li>• Debounced multi-source search</li>
                                            <li>• Real-time WebSocket communication</li>
                                            <li>• Streaming AI responses</li>
                                            <li>• Markdown message support</li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="space-y-6">
                                    <div class="border-l-4 border-purple-500 pl-4 hover:bg-light p-3 rounded transition-colors">
                                        <h4 class="text-lg font-semibold text-purple-600">Transcriptions</h4>
                                        <p class="text-secondary mb-3">Video/audio transcription service</p>
                                        <ul class="text-sm space-y-1">
                                            <li>• Client-side FFmpeg processing</li>
                                            <li>• Faster Whisper (Python bridge, 4x faster)</li>
                                            <li>• SQLite storage for transcripts</li>
                                            <li>• Interactive transcript editor</li>
                                            <li>• Waveform visualization</li>
                                        </ul>
                                    </div>
                                    <div class="border-l-4 border-orange-500 pl-4 hover:bg-light p-3 rounded transition-colors">
                                        <h4 class="text-lg font-semibold text-orange-600">Notes Module</h4>
                                        <p class="text-secondary mb-3">Rich text note-taking application</p>
                                        <ul class="text-sm space-y-1">
                                            <li>• BlockNote rich text editor</li>
                                            <li>• SQLite + File System storage</li>
                                            <li>• Note management system</li>
                                            <li>• Real-time collaboration ready</li>
                                        </ul>
                                    </div>
                                    <div class="border-l-4 border-red-500 pl-4 hover:bg-light p-3 rounded transition-colors">
                                        <h4 class="text-lg font-semibold text-red-600">Files Module</h4>
                                        <p class="text-secondary mb-3">Comprehensive file management</p>
                                        <ul class="text-sm space-y-1">
                                            <li>• Multi-modal file uploads</li>
                                            <li>• Hierarchical file organization</li>
                                            <li>• File preview generation</li>
                                            <li>• Cloud storage integration</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Communication Patterns with Interactive Visualization -->
                        <div id="communication-patterns" class="bg-white rounded-lg shadow-lg p-8 card-hover">
                            <div class="mb-6">
                                <h3 class="text-2xl font-semibold">Inter-Module Communication</h3>
                            </div>
                            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                                <div class="text-center p-6 bg-light rounded-lg hover:bg-primary hover:text-white transition-colors cursor-pointer" onclick="showCommunicationDetail('state-sharing')">
                                    <div class="w-16 h-16 bg-primary rounded-full flex items-center justify-center mx-auto mb-4">
                                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                                        </svg>
                                    </div>
                                    <h4 class="text-lg font-semibold mb-2">State Sharing</h4>
                                    <p class="text-sm text-secondary">Zustand stores for global state management</p>
                                </div>
                                <div class="text-center p-6 bg-light rounded-lg hover:bg-accent hover:text-white transition-colors cursor-pointer" onclick="showCommunicationDetail('event-system')">
                                    <div class="w-16 h-16 bg-accent rounded-full flex items-center justify-center mx-auto mb-4">
                                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 4V2a1 1 0 011-1h8a1 1 0 011 1v2m0 0V1a1 1 0 011-1h2a1 1 0 011 1v18a1 1 0 01-1 1H4a1 1 0 01-1-1V4a1 1 0 011-1h2a1 1 0 011 1v2"></path>
                                        </svg>
                                    </div>
                                    <h4 class="text-lg font-semibold mb-2">Event System</h4>
                                    <p class="text-sm text-secondary">CustomEvent API for decoupled communication</p>
                                </div>
                                <div class="text-center p-6 bg-light rounded-lg hover:bg-green-500 hover:text-white transition-colors cursor-pointer" onclick="showCommunicationDetail('oauth-flow')">
                                    <div class="w-16 h-16 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"></path>
                                        </svg>
                                    </div>
                                    <h4 class="text-lg font-semibold mb-2">OAuth Flow</h4>
                                    <p class="text-sm text-secondary">postMessage API for authentication</p>
                                </div>
                                <div class="text-center p-6 bg-light rounded-lg hover:bg-purple-500 hover:text-white transition-colors cursor-pointer" onclick="showCommunicationDetail('routing')">
                                    <div class="w-16 h-16 bg-purple-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path>
                                        </svg>
                                    </div>
                                    <h4 class="text-lg font-semibold mb-2">Routing</h4>
                                    <p class="text-sm text-secondary">URL parameters for module communication</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Part 3: Architecture Comparison -->
            <section id="architecture-comparison" class="py-16 bg-gray-50">
                <div class="container mx-auto px-6">
                    <div class="max-w-6xl mx-auto">
                        <div class="mb-8">
                            <h2 class="text-3xl lg:text-4xl font-bold text-center">Part 3: Architecture Comparison</h2>
                        </div>
                        
                        <!-- Interactive Comparison Table -->
                        <div class="bg-white rounded-lg shadow-lg p-8 mb-8 card-hover">
                            <div class="mb-6">
                                <h3 class="text-2xl font-semibold">Micro Frontend vs Local-First Desktop Architecture</h3>
                            </div>
                            <div class="overflow-x-auto">
                                <table class="comparison-table w-full">
                                    <thead>
                                        <tr class="bg-primary text-white">
                                            <th class="text-left">Aspect</th>
                                            <th class="text-left">Current MFE Architecture</th>
                                            <th class="text-left">Proposed Local-First Desktop</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="table-row hover:bg-blue-50">
                                            <td class="font-semibold">Data Storage</td>
                                            <td>Cloud-based, remote servers</td>
                                            <td>SQLite + File System (Electron Desktop)</td>
                                        </tr>
                                        <tr class="table-row hover:bg-blue-50">
                                            <td class="font-semibold">Offline Capability</td>
                                            <td class="text-red-600">❌ None</td>
                                            <td class="text-green-600">✅ Full offline functionality</td>
                                        </tr>
                                        <tr class="table-row hover:bg-blue-50">
                                            <td class="font-semibold">Initial Load Time</td>
                                            <td>High (multiple bundle downloads)</td>
                                            <td>Fast (single desktop app)</td>
                                        </tr>
                                        <tr class="table-row hover:bg-blue-50">
                                            <td class="font-semibold">Network Dependency</td>
                                            <td class="text-red-600">❌ Required for all operations</td>
                                            <td class="text-green-600">✅ Optional for sync only</td>
                                        </tr>
                                        <tr class="table-row hover:bg-blue-50">
                                            <td class="font-semibold">Real-time Collaboration</td>
                                            <td>Limited to WebSocket connections</td>
                                            <td>CRDT-based collaborative editing</td>
                                        </tr>
                                        <tr class="table-row hover:bg-blue-50">
                                            <td class="font-semibold">Data Privacy</td>
                                            <td class="text-red-600">❌ All data in cloud</td>
                                            <td class="text-green-600">✅ Local data ownership</td>
                                        </tr>
                                        <tr class="table-row hover:bg-blue-50">
                                            <td class="font-semibold">Deployment Complexity</td>
                                            <td>High (multiple repositories)</td>
                                            <td>Medium (single application)</td>
                                        </tr>
                                        <tr class="table-row hover:bg-blue-50">
                                            <td class="font-semibold">Performance</td>
                                            <td>Network-bound operations</td>
                                            <td>Local performance, instant responses</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Interactive Performance Analysis -->
                        <div id="performance-analysis" class="bg-white rounded-lg shadow-lg p-8 card-hover">
                            <div class="mb-6">
                                <h3 class="text-2xl font-semibold">Performance Analysis</h3>
                            </div>
                            <div class="grid lg:grid-cols-2 gap-8">
                                <div class="space-y-4">
                                    <h4 class="text-lg font-semibold text-primary">Performance Comparison Chart</h4>
                                    <div class="chart-container" style="position: relative; height: 400px; width: 100%;">
                                        <canvas id="performanceChart" style="max-width: 100%; height: 100%;"></canvas>
                                    </div>
                                </div>
                                <div class="space-y-4">
                                    <h4 class="text-lg font-semibold text-primary">Key Metrics</h4>
                                    <div class="grid grid-cols-1 gap-4">
                                        <div class="text-center p-6 bg-red-50 rounded-lg">
                                            <div class="text-3xl font-bold text-red-600 mb-2">2.5s</div>
                                            <div class="text-sm font-semibold mb-2">Current MFE Load Time</div>
                                            <div class="text-xs text-secondary">Multiple bundle downloads</div>
                                        </div>
                                        <div class="text-center p-6 bg-green-50 rounded-lg">
                                            <div class="text-3xl font-bold text-green-600 mb-2">0.8s</div>
                                            <div class="text-sm font-semibold mb-2">Desktop App Load Time</div>
                                            <div class="text-xs text-secondary">Local asset delivery</div>
                                        </div>
                                        <div class="text-center p-6 bg-blue-50 rounded-lg">
                                            <div class="text-3xl font-bold text-blue-600 mb-2">68%</div>
                                            <div class="text-sm font-semibold mb-2">Performance Improvement</div>
                                            <div class="text-xs text-secondary">Faster initial load</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Part 4: Migration Strategy -->
            <section id="migration-timeline" class="py-16 bg-white">
                <div class="container mx-auto px-6">
                    <div class="max-w-6xl mx-auto">
                        <div class="mb-8">
                            <h2 class="text-3xl lg:text-4xl font-bold text-center">Part 4: Migration Strategy</h2>
                        </div>
                        
                        <!-- Interactive Timeline -->
                        <div class="bg-white rounded-lg shadow-lg p-8 mb-8 card-hover">
                            <div class="mb-8">
                                <h3 class="text-2xl font-semibold">Accelerated Migration Timeline (3 Months)</h3>
                            </div>
                            <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-6">
                                <p class="text-sm text-blue-900">
                                    <strong>Note:</strong> Timeline compressed to 3 months by leveraging existing MFE codebases. 
                                    Since all modules share React 18.2+, TypeScript 5.0+, and Vite 5.4.6, we can parallelize 
                                    adaptation work and reuse 80%+ of existing UI components within our monorepo structure.
                                </p>
                            </div>
                            <div class="relative">
                                <div class="absolute left-8 top-0 bottom-0 w-0.5 bg-gray-300"></div>
                                <div class="space-y-12">
                                    <!-- Phase 1 -->
                                    <div class="relative timeline-item">
                                        <div class="flex items-start ml-16">
                                            <div class="bg-primary text-white rounded-lg p-4 flex-1">
                                                <div class="flex items-center justify-between mb-2">
                                                    <h4 class="text-lg font-semibold">Phase 1: Foundation & Infrastructure (Weeks 1-3)</h4>
                                                    <span class="text-sm bg-white bg-opacity-20 px-2 py-1 rounded">Month 1</span>
                                                </div>
                                                <p class="text-sm opacity-90 mb-3">Establish monorepo, desktop wrapper, and core infrastructure</p>
                                                <ul class="text-xs space-y-1 opacity-80">
                                                    <li>• <strong>Week 1: Monorepo & Desktop Setup</strong></li>
                                                    <li>&nbsp;&nbsp;- Initialize monorepo (pnpm workspaces) with DDD structure</li>
                                                    <li>&nbsp;&nbsp;- Electron Forge + React 19 (upgrade from 18.2)</li>
                                                    <li>&nbsp;&nbsp;- Vite configs (main/preload/renderer)</li>
                                                    <li>&nbsp;&nbsp;- Setup packages/desktop, packages/shared, packages/ui</li>
                                                    <li>• <strong>Week 2: Database & Storage Layer</strong></li>
                                                    <li>&nbsp;&nbsp;- SQLite setup (better-sqlite3) with CRDT-ready schema</li>
                                                    <li>&nbsp;&nbsp;- Database migrations infrastructure</li>
                                                    <li>&nbsp;&nbsp;- IPC handlers for database operations</li>
                                                    <li>&nbsp;&nbsp;- File system service (Electron APIs)</li>
                                                    <li>• <strong>Week 3: Auth & Python Bridge</strong></li>
                                                    <li>&nbsp;&nbsp;- Authentication service (local + cloud sync)</li>
                                                    <li>&nbsp;&nbsp;- Python runtime integration (bundled with app)</li>
                                                    <li>&nbsp;&nbsp;- Python bridge IPC setup for AI features</li>
                                                    <li>&nbsp;&nbsp;- Sync architecture design (CRDT engine prep)</li>
                                                    <li>• <strong>Deliverable:</strong> Working desktop shell with SQLite + auth + Python bridge</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Phase 2 -->
                                    <div class="relative timeline-item">
                                        <div class="flex items-start ml-16">
                                            <div class="bg-accent text-white rounded-lg p-4 flex-1">
                                                <div class="flex items-center justify-between mb-2">
                                                    <h4 class="text-lg font-semibold">Phase 2: Core Modules Migration (Weeks 4-6)</h4>
                                                    <span class="text-sm bg-white bg-opacity-20 px-2 py-1 rounded">Month 2</span>
                                                </div>
                                                <p class="text-sm opacity-90 mb-3">Migrate core modules to MVVM pattern with local-first architecture</p>
                                                <ul class="text-xs space-y-1 opacity-80">
                                                    <li>• <strong>Week 4: Notes & Files Domains</strong></li>
                                                    <li>&nbsp;&nbsp;- <strong>Notes:</strong> MVVM ViewModels (Zustand) + SQLite repositories</li>
                                                    <li>&nbsp;&nbsp;- BlockNote editor integration for local editing</li>
                                                    <li>&nbsp;&nbsp;- <strong>Files:</strong> File system + SQLite metadata storage</li>
                                                    <li>&nbsp;&nbsp;- File preview generation (thumbnails)</li>
                                                    <li>&nbsp;&nbsp;- Migrate existing React components to packages/domains/</li>
                                                    <li>• <strong>Week 5: Home Dashboard & UI Library</strong></li>
                                                    <li>&nbsp;&nbsp;- Storybook 9 setup for component library</li>
                                                    <li>&nbsp;&nbsp;- Migrate Shadcn/ui components to packages/ui/</li>
                                                    <li>&nbsp;&nbsp;- Home dashboard with local data aggregation</li>
                                                    <li>&nbsp;&nbsp;- Unified navigation and routing</li>
                                                    <li>• <strong>Week 6: Offline Sync Implementation</strong></li>
                                                    <li>&nbsp;&nbsp;- CRDT engine (vector clocks + conflict resolution)</li>
                                                    <li>&nbsp;&nbsp;- Sync queue for offline operations</li>
                                                    <li>&nbsp;&nbsp;- Background sync service (WebSocket + REST fallback)</li>
                                                    <li>&nbsp;&nbsp;- Integration tests (Vitest unit + integration)</li>
                                                    <li>• <strong>Deliverable:</strong> Notes & Files working offline with background sync</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Phase 3 -->
                                    <div class="relative timeline-item">
                                        <div class="flex items-start ml-16">
                                            <div class="bg-green-500 text-white rounded-lg p-4 flex-1">
                                                <div class="flex items-center justify-between mb-2">
                                                    <h4 class="text-lg font-semibold">Phase 3: Advanced Features & AI (Weeks 7-9)</h4>
                                                    <span class="text-sm bg-white bg-opacity-20 px-2 py-1 rounded">Month 2-3</span>
                                                </div>
                                                <p class="text-sm opacity-90 mb-3">Implement advanced modules with native binaries and AI features</p>
                                                <ul class="text-xs space-y-1 opacity-80">
                                                    <li>• <strong>Week 7: Search & Chat Domain</strong></li>
                                                    <li>&nbsp;&nbsp;- Local search indexing (MiniSearch for full-text search)</li>
                                                    <li>&nbsp;&nbsp;- Embedding service (Transformers.js for local embeddings)</li>
                                                    <li>&nbsp;&nbsp;- Chat interface with local history (SQLite)</li>
                                                    <li>&nbsp;&nbsp;- Offline-first search with cloud augmentation</li>
                                                    <li>• <strong>Week 8: Transcriptions with Native Binaries</strong></li>
                                                    <li>&nbsp;&nbsp;- Bundle FFmpeg 8.0 native binary (cross-platform)</li>
                                                    <li>&nbsp;&nbsp;- FFmpeg service for audio extraction</li>
                                                    <li>&nbsp;&nbsp;- Faster Whisper integration via Python bridge</li>
                                                    <li>&nbsp;&nbsp;- yt-dlp integration for YouTube downloads</li>
                                                    <li>&nbsp;&nbsp;- Transcription queue and progress tracking</li>
                                                    <li>&nbsp;&nbsp;- Waveform visualization (existing component reuse)</li>
                                                    <li>• <strong>Week 9: Collaboration (CRDT)</strong></li>
                                                    <li>&nbsp;&nbsp;- Y.js integration for real-time collaboration</li>
                                                    <li>&nbsp;&nbsp;- WebRTC peer-to-peer sync setup</li>
                                                    <li>&nbsp;&nbsp;- Conflict-free note editing</li>
                                                    <li>&nbsp;&nbsp;- Presence indicators and collaborative cursors</li>
                                                    <li>• <strong>Deliverable:</strong> All modules functional with AI features and collaboration</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Phase 4 -->
                                    <div class="relative timeline-item">
                                        <div class="flex items-start ml-16">
                                            <div class="bg-purple-500 text-white rounded-lg p-4 flex-1">
                                                <div class="flex items-center justify-between mb-2">
                                                    <h4 class="text-lg font-semibold">Phase 4: Quality Assurance & Production (Weeks 10-12)</h4>
                                                    <span class="text-sm bg-white bg-opacity-20 px-2 py-1 rounded">Month 3</span>
                                                </div>
                                                <p class="text-sm opacity-90 mb-3">Comprehensive testing, optimization, and production deployment</p>
                                                <ul class="text-xs space-y-1 opacity-80">
                                                    <li>• <strong>Week 10: Testing & Performance</strong></li>
                                                    <li>&nbsp;&nbsp;- Playwright E2E test suite (critical user paths)</li>
                                                    <li>&nbsp;&nbsp;- Performance profiling and optimization</li>
                                                    <li>&nbsp;&nbsp;- Memory leak detection and fixes</li>
                                                    <li>&nbsp;&nbsp;- Database query optimization (SQLite indexes)</li>
                                                    <li>&nbsp;&nbsp;- Binary size optimization (FFmpeg, Python runtime)</li>
                                                    <li>• <strong>Week 11: Beta Testing & Polish</strong></li>
                                                    <li>&nbsp;&nbsp;- Internal beta release (team testing)</li>
                                                    <li>&nbsp;&nbsp;- User feedback collection and prioritization</li>
                                                    <li>&nbsp;&nbsp;- Critical bug fixes</li>
                                                    <li>&nbsp;&nbsp;- UX polish and animations</li>
                                                    <li>&nbsp;&nbsp;- Error handling and user messaging improvements</li>
                                                    <li>• <strong>Week 12: Production Deployment</strong></li>
                                                    <li>&nbsp;&nbsp;- CI/CD pipeline (.github/workflows)</li>
                                                    <li>&nbsp;&nbsp;- Code signing (macOS, Windows)</li>
                                                    <li>&nbsp;&nbsp;- Auto-update mechanism (Electron updater)</li>
                                                    <li>&nbsp;&nbsp;- Production builds (Windows .exe, macOS .dmg, Linux .AppImage)</li>
                                                    <li>&nbsp;&nbsp;- Monitoring and analytics setup (Sentry, PostHog)</li>
                                                    <li>&nbsp;&nbsp;- Release documentation and changelog</li>
                                                    <li>• <strong>Deliverable:</strong> Production-ready desktop app on all platforms</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Migration Phases Detail -->
                        <div id="migration-phases" class="bg-white rounded-lg shadow-lg p-8 card-hover">
                            <div class="collapsible-header p-6 flex items-center justify-between cursor-pointer" onclick="toggleCollapsible(this)">
                                    <h3 class="text-2xl font-semibold">Detailed Migration Phases</h3>
                                <svg class="w-6 h-6 text-secondary transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                </svg>
                            </div>
                            <div class="collapsible-content">
                                <div class="px-6 pb-6 pt-0">
                                    <div class="mb-6 bg-green-50 border-l-4 border-green-500 p-4">
                                        <h5 class="font-semibold text-green-900 mb-2">🚀 Acceleration Strategies</h5>
                                        <div class="text-sm text-green-800 space-y-1">
                                            <p>• <strong>Code Reuse:</strong> 80%+ of existing React components work as-is within monorepo packages/domains/</p>
                                            <p>• <strong>Parallel Development:</strong> 4 teams work on different layers (Infrastructure, Domains, AI, QA) simultaneously</p>
                                            <p>• <strong>Shared Tech Stack:</strong> React 18.2→19, TypeScript 5.0+, Vite 5.4.6 - no retraining needed</p>
                                            <p>• <strong>Existing Patterns:</strong> Transcriptions already uses FFmpeg (switch to native binary), add Faster Whisper via Python bridge</p>
                                            <p>• <strong>Monorepo Benefits:</strong> DDD structure enables independent package development with shared utilities and UI components</p>
                                        </div>
                                    </div>
                                    <div class="grid lg:grid-cols-2 gap-8">
                                        <div>
                                            <h4 class="text-lg font-semibold mb-4 text-primary">Technical Migration Tasks</h4>
                                            <div class="space-y-4">
                                                <div class="p-4 bg-light rounded-lg">
                                                    <div class="font-semibold mb-2">Week 1-3: Foundation & Infrastructure</div>
                                                    <div class="text-sm text-secondary">
                                                        • Monorepo setup (pnpm workspaces, DDD structure)<br>
                                                        • Electron Forge + React 19 + Vite configs<br>
                                                        • SQLite (better-sqlite3) with CRDT schema<br>
                                                        • Python runtime bundling for AI features<br>
                                                        • IPC handlers (database, files, transcription, sync)<br>
                                                        • Authentication service (local + cloud sync)
                                                    </div>
                                                </div>
                                                <div class="p-4 bg-light rounded-lg">
                                                    <div class="font-semibold mb-2">Week 4-6: Domain Migration (MVVM)</div>
                                                    <div class="text-sm text-secondary">
                                                        • <strong>Notes:</strong> Zustand ViewModels + SQLite repositories + BlockNote editor<br>
                                                        • <strong>Files:</strong> File system + SQLite metadata + thumbnails<br>
                                                        • <strong>Home:</strong> Dashboard with local aggregation<br>
                                                        • Storybook 9 setup for UI component library<br>
                                                        • Migrate Shadcn/ui to packages/ui/<br>
                                                        • CRDT engine + sync queue + background sync
                                                    </div>
                                                </div>
                                                <div class="p-4 bg-light rounded-lg">
                                                    <div class="font-semibold mb-2">Week 7-9: Advanced Features & AI</div>
                                                    <div class="text-sm text-secondary">
                                                        • <strong>Search:</strong> MiniSearch indexing + Transformers.js embeddings<br>
                                                        • <strong>Chat:</strong> Local history + offline search<br>
                                                        • <strong>Transcriptions:</strong> FFmpeg 8.0 native + Faster Whisper + yt-dlp<br>
                                                        • Cross-platform binary bundling (Win/Mac/Linux)<br>
                                                        • Y.js CRDT for real-time collaboration<br>
                                                        • WebRTC peer-to-peer sync
                                                    </div>
                                                </div>
                                                <div class="p-4 bg-light rounded-lg">
                                                    <div class="font-semibold mb-2">Week 10-12: QA & Production</div>
                                                    <div class="text-sm text-secondary">
                                                        • Vitest unit + integration tests<br>
                                                        • Playwright E2E test suite<br>
                                                        • Performance optimization + memory profiling<br>
                                                        • Code signing (macOS/Windows)<br>
                                                        • CI/CD pipeline + auto-updates<br>
                                                        • Multi-platform builds (.exe/.dmg/.AppImage)
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div>
                                            <h4 class="text-lg font-semibold mb-4 text-green-600">Parallel Workstreams (4 Teams)</h4>
                                            <div class="space-y-4">
                                                <div class="p-4 bg-light rounded-lg">
                                                    <div class="font-semibold mb-2">Team A: Core Infrastructure (3-4 devs)</div>
                                                    <div class="text-sm text-secondary">
                                                        • <strong>Weeks 1-3:</strong> Monorepo + Electron Forge + SQLite + Python bridge<br>
                                                        • <strong>Weeks 4-6:</strong> CRDT engine + sync service + IPC layer<br>
                                                        • <strong>Weeks 7-9:</strong> WebRTC P2P + performance optimization<br>
                                                        • <strong>Weeks 10-12:</strong> Infrastructure testing + monitoring
                                                    </div>
                                                </div>
                                                <div class="p-4 bg-light rounded-lg">
                                                    <div class="font-semibold mb-2">Team B: Domain Migration (3-4 devs)</div>
                                                    <div class="text-sm text-secondary">
                                                        • <strong>Weeks 1-3:</strong> Setup packages/domains/ structure<br>
                                                        • <strong>Weeks 4-6:</strong> Notes, Files, Home (MVVM pattern migration)<br>
                                                        • <strong>Weeks 7-9:</strong> Search & Chat domain implementation<br>
                                                        • <strong>Weeks 10-12:</strong> Domain integration testing + bug fixes
                                                    </div>
                                                </div>
                                                <div class="p-4 bg-light rounded-lg">
                                                    <div class="font-semibold mb-2">Team C: Media & AI (2-3 devs)</div>
                                                    <div class="text-sm text-secondary">
                                                        • <strong>Weeks 1-3:</strong> Python runtime setup + research<br>
                                                        • <strong>Weeks 4-6:</strong> Embedding service (Transformers.js)<br>
                                                        • <strong>Weeks 7-9:</strong> FFmpeg 8.0 + Faster Whisper + yt-dlp integration<br>
                                                        • <strong>Weeks 10-12:</strong> Cross-platform binary testing + optimization
                                                    </div>
                                                </div>
                                                <div class="p-4 bg-light rounded-lg">
                                                    <div class="font-semibold mb-2">Team D: QA & DevOps (2-3 devs)</div>
                                                    <div class="text-sm text-secondary">
                                                        • <strong>Weeks 1-3:</strong> CI/CD pipeline + test framework setup<br>
                                                        • <strong>Weeks 4-6:</strong> Unit test development (Vitest)<br>
                                                        • <strong>Weeks 7-9:</strong> E2E test development (Playwright)<br>
                                                        • <strong>Weeks 10-12:</strong> Full test suite + deployment automation + code signing
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mt-8 bg-yellow-50 border-l-4 border-yellow-500 p-4">
                                        <h5 class="font-semibold text-yellow-900 mb-2">⚠️ Critical Success Factors</h5>
                                        <div class="text-sm text-yellow-800 space-y-1">
                                            <p>• <strong>Resource Allocation:</strong> 12-14 full-time developers (3-4 per team) dedicated for full 3 months</p>
                                            <p>• <strong>Clear Communication:</strong> Daily standups (15min), weekly integration meetings, architecture reviews</p>
                                            <p>• <strong>Scope Management:</strong> Lock features after Week 3 (Phase 1 complete), no scope creep allowed</p>
                                            <p>• <strong>Risk Mitigation:</strong> Maintain web MFE version as fallback during entire migration period</p>
                                            <p>• <strong>Monorepo Discipline:</strong> Enforce package boundaries, shared dependencies in root, no circular dependencies</p>
                                            <p>• <strong>Testing First:</strong> Write tests before migration (TDD approach), maintain 80%+ coverage throughout</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Part 5: Technical Specifications -->
            <section id="technical-architecture" class="py-16 bg-gray-50">
                <div class="container mx-auto px-6">
                    <div class="max-w-6xl mx-auto">
                        <div class="mb-8">
                            <h2 class="text-3xl lg:text-4xl font-bold text-center">Part 5: Technical Specifications</h2>
                        </div>
                        
                        <!-- Technical Architecture -->
                        <div class="bg-white rounded-lg shadow-lg p-8 mb-8 card-hover">
                            <div class="mb-6">
                                <h3 class="text-2xl font-semibold">Proposed Local-First Architecture</h3>
                            </div>
                            
                            <!-- Architecture Patterns -->
                            <div class="mb-8 bg-gradient-to-r from-blue-50 to-purple-50 border-l-4 border-blue-500 p-6 rounded-r-lg">
                                <h4 class="text-lg font-semibold mb-3 text-blue-900">Architecture Patterns</h4>
                                <div class="grid md:grid-cols-2 gap-4 text-sm">
                                    <div class="flex items-start">
                                        <div class="w-2 h-2 bg-blue-500 rounded-full mt-2 mr-3"></div>
                                        <div>
                                            <strong class="text-blue-900">Monorepo Structure:</strong>
                                            <p class="text-blue-800">Single repository containing all modules with shared dependencies and unified build system</p>
                                        </div>
                                    </div>
                                    <div class="flex items-start">
                                        <div class="w-2 h-2 bg-purple-500 rounded-full mt-2 mr-3"></div>
                                        <div>
                                            <strong class="text-purple-900">DDD (Domain-Driven Design):</strong>
                                            <p class="text-purple-800">Organize code around business domains (Notes, Files, Transcriptions, etc.)</p>
                                        </div>
                                    </div>
                                    <div class="flex items-start">
                                        <div class="w-2 h-2 bg-indigo-500 rounded-full mt-2 mr-3"></div>
                                        <div>
                                            <strong class="text-indigo-900">MVVM Pattern:</strong>
                                            <p class="text-indigo-800">Model-View-ViewModel for clean separation of concerns and testability</p>
                                        </div>
                                    </div>
                                    <div class="flex items-start">
                                        <div class="w-2 h-2 bg-green-500 rounded-full mt-2 mr-3"></div>
                                        <div>
                                            <strong class="text-green-900">CRDT Ready:</strong>
                                            <p class="text-green-800">Built-in support for Conflict-free Replicated Data Types for real-time collaboration</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="grid lg:grid-cols-3 gap-6">
                                <div class="bg-light p-6 rounded-lg">
                                    <h4 class="text-lg font-semibold mb-4 text-primary">Desktop Application Layer</h4>
                                    <ul class="text-sm space-y-2">
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-primary rounded-full mr-2"></div>
                                            <strong>Electron.js</strong> + Electron Forge
                                        </li>
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-primary rounded-full mr-2"></div>
                                            <strong>React 19</strong> (stable) UI Components
                                        </li>
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-primary rounded-full mr-2"></div>
                                            TypeScript 5.0+ Development
                                        </li>
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-primary rounded-full mr-2"></div>
                                            Vite 5.4.6 Build System
                                        </li>
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-primary rounded-full mr-2"></div>
                                            Tailwind CSS Styling
                                        </li>
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-primary rounded-full mr-2"></div>
                                            <strong>Storybook 9</strong> (stable) Component Library
                                        </li>
                                    </ul>
                                </div>
                                <div class="bg-light p-6 rounded-lg">
                                    <h4 class="text-lg font-semibold mb-4 text-green-600">Local Data & Storage</h4>
                                    <ul class="text-sm space-y-2">
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                                            <strong>SQLite</strong> Primary Database
                                        </li>
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                                            CRDT-Ready Data Structures
                                        </li>
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                                            SQLite + File System (Electron)
                                        </li>
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                                            Zustand 4.4.6 State Management
                                        </li>
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                                            File System Direct Access
                                        </li>
                                    </ul>
                                </div>
                                <div class="bg-light p-6 rounded-lg">
                                    <h4 class="text-lg font-semibold mb-4 text-purple-600">Media Processing</h4>
                                    <ul class="text-sm space-y-2">
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-purple-500 rounded-full mr-2 flex-shrink-0"></div>
                                            <span><strong>FFmpeg 8.0</strong> Video/Audio Processing</span>
                                        </li>
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-purple-500 rounded-full mr-2 flex-shrink-0"></div>
                                            <span><strong>Faster Whisper</strong> AI Transcription (via Python bridge)</span>
                                        </li>
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-purple-500 rounded-full mr-2 flex-shrink-0"></div>
                                            <span>Python Runtime (bundled with Electron)</span>
                                        </li>
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-purple-500 rounded-full mr-2 flex-shrink-0"></div>
                                            <span><strong>yt-dlp</strong> YouTube Download</span>
                                        </li>
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-purple-500 rounded-full mr-2 flex-shrink-0"></div>
                                            <span>Local AI Model Inference</span>
                                        </li>
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-purple-500 rounded-full mr-2 flex-shrink-0"></div>
                                            <span>Translation Services</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            
                            <!-- Additional Tech Stack Row -->
                            <div class="grid lg:grid-cols-3 gap-6 mt-6">
                                <div class="bg-light p-6 rounded-lg">
                                    <h4 class="text-lg font-semibold mb-4 text-accent">Sync & Network Layer</h4>
                                    <ul class="text-sm space-y-2">
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-accent rounded-full mr-2"></div>
                                            WebRTC Peer-to-Peer
                                        </li>
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-accent rounded-full mr-2"></div>
                                            WebSocket Real-time Sync
                                        </li>
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-accent rounded-full mr-2"></div>
                                            REST API Cloud Integration
                                        </li>
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-accent rounded-full mr-2"></div>
                                            Background Sync Service
                                        </li>
                                    </ul>
                                </div>
                                <div class="bg-light p-6 rounded-lg">
                                    <h4 class="text-lg font-semibold mb-4 text-orange-600">Development Tools</h4>
                                    <ul class="text-sm space-y-2">
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-orange-500 rounded-full mr-2"></div>
                                            ESLint + Prettier Code Quality
                                        </li>
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-orange-500 rounded-full mr-2"></div>
                                            Vitest Unit Testing
                                        </li>
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-orange-500 rounded-full mr-2"></div>
                                            Playwright E2E Testing
                                        </li>
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-orange-500 rounded-full mr-2"></div>
                                            React Query v5 Data Fetching
                                        </li>
                                    </ul>
                                </div>
                                <div class="bg-light p-6 rounded-lg">
                                    <h4 class="text-lg font-semibold mb-4 text-red-600">UI Component Library</h4>
                                    <ul class="text-sm space-y-2">
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-red-500 rounded-full mr-2"></div>
                                            Radix UI Primitives
                                        </li>
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-red-500 rounded-full mr-2"></div>
                                            Shadcn/ui Components
                                        </li>
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-red-500 rounded-full mr-2"></div>
                                            React Hook Form
                                        </li>
                                        <li class="flex items-center">
                                            <div class="w-2 h-2 bg-red-500 rounded-full mr-2"></div>
                                            Lucide React Icons
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Code Examples -->
                        <div class="bg-white rounded-lg shadow-lg p-8 mb-8 card-hover">
                            <div class="mb-6">
                                <h3 class="text-2xl font-semibold">Implementation Examples</h3>
                            </div>
                            
                            <!-- Accordion 0: Architecture Patterns Explained -->
                            <div class="mb-4 border border-gray-200 rounded-lg">
                                <div class="collapsible-header p-4 flex items-center justify-between cursor-pointer hover:bg-gray-50" onclick="toggleCollapsible(this)">
                                    <h4 class="text-lg font-semibold text-indigo-900">🏗️ Architecture Patterns Explained</h4>
                                    <svg class="w-5 h-5 text-secondary transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                    </svg>
                            </div>
                                <div class="collapsible-content">
                                    <div class="p-6 bg-indigo-50">
                                        <div class="space-y-6">
                                            
                                            <!-- Monorepo Structure -->
                                            <div class="bg-white p-5 rounded-lg border-l-4 border-blue-500">
                                                <h5 class="text-lg font-bold text-blue-900 mb-3 flex items-center">
                                                    <span class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3 text-sm">1</span>
                                                    Monorepo Structure
                                                </h5>
                                                <p class="text-gray-700 mb-3">
                                                    <strong>What it is:</strong> A single repository containing multiple related projects (packages) that can depend on each other.
                                                </p>
                                                <p class="text-gray-700 mb-3">
                                                    <strong>Why we use it:</strong> Simplifies dependency management, enables code sharing, and ensures consistency across all modules. Changes can be tested across all packages simultaneously.
                                                </p>
                                                <div class="bg-blue-50 p-4 rounded-lg">
                                                    <p class="font-semibold text-blue-900 mb-2">Example in our architecture:</p>
                                                    <div class="text-sm space-y-1 font-mono text-gray-800">
                                                        <div>📦 <strong>packages/ui/</strong> → Shared UI components (buttons, forms)</div>
                                                        <div>📦 <strong>packages/domains/notes/</strong> → Uses UI components</div>
                                                        <div>📦 <strong>packages/domains/files/</strong> → Uses UI components</div>
                                                        <div>📦 <strong>packages/shared/</strong> → Types & utilities used by all</div>
                                                    </div>
                                                    <p class="text-gray-700 mt-3 text-sm">
                                                        ✅ Update a button in <code class="bg-blue-200 px-1 rounded">packages/ui/</code> → All domains get the update automatically<br>
                                                        ✅ Change a TypeScript type → TypeScript ensures all packages are compatible
                                                    </p>
                                                </div>
                                            </div>

                                            <!-- DDD (Domain-Driven Design) -->
                                            <div class="bg-white p-5 rounded-lg border-l-4 border-green-500">
                                                <h5 class="text-lg font-bold text-green-900 mb-3 flex items-center">
                                                    <span class="bg-green-500 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3 text-sm">2</span>
                                                    DDD (Domain-Driven Design)
                                                </h5>
                                                <p class="text-gray-700 mb-3">
                                                    <strong>What it is:</strong> Organizing code around business domains (Notes, Files, Transcriptions) rather than technical layers (controllers, services, models).
                                                </p>
                                                <p class="text-gray-700 mb-3">
                                                    <strong>Why we use it:</strong> Each domain is self-contained with its own models, services, and views. Teams can work independently on different domains without conflicts.
                                                </p>
                                                <div class="bg-green-50 p-4 rounded-lg">
                                                    <p class="font-semibold text-green-900 mb-2">Example: Notes Domain</p>
                                                    <div class="text-sm space-y-1 font-mono text-gray-800">
                                                        <div>📁 <strong>packages/domains/notes/</strong></div>
                                                        <div class="ml-4">├── <strong>models/</strong> → <code>Note.ts</code>, <code>NoteTag.ts</code> (data structures)</div>
                                                        <div class="ml-4">├── <strong>services/</strong> → <code>NotesService.ts</code> (business logic)</div>
                                                        <div class="ml-4">├── <strong>repositories/</strong> → <code>NotesRepository.ts</code> (database access)</div>
                                                        <div class="ml-4">├── <strong>viewmodels/</strong> → <code>useNotesViewModel.ts</code> (state management)</div>
                                                        <div class="ml-4">└── <strong>views/</strong> → <code>NotesList.tsx</code>, <code>NoteEditor.tsx</code> (UI components)</div>
                                                    </div>
                                                    <p class="text-gray-700 mt-3 text-sm">
                                                        ✅ Everything related to Notes is in one place<br>
                                                        ✅ Notes domain can be developed, tested, and deployed independently<br>
                                                        ✅ Easy to understand: "Want to change how notes work? Look in domains/notes/"
                                                    </p>
                                                </div>
                                            </div>

                                            <!-- MVVM Pattern -->
                                            <div class="bg-white p-5 rounded-lg border-l-4 border-purple-500">
                                                <h5 class="text-lg font-bold text-purple-900 mb-3 flex items-center">
                                                    <span class="bg-purple-500 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3 text-sm">3</span>
                                                    MVVM Pattern (Model-View-ViewModel)
                                                </h5>
                                                <p class="text-gray-700 mb-3">
                                                    <strong>What it is:</strong> A design pattern that separates data (Model), UI (View), and business logic + state (ViewModel).
                                                </p>
                                                <p class="text-gray-700 mb-3">
                                                    <strong>Why we use it:</strong> Clean separation of concerns. UI components don't contain business logic. Makes testing easier and code more maintainable.
                                                </p>
                                                <div class="bg-purple-50 p-4 rounded-lg">
                                                    <p class="font-semibold text-purple-900 mb-2">Example: Note Editor</p>
                                                    <div class="space-y-3">
                                                        <div class="bg-white p-3 rounded border-l-2 border-purple-300">
                                                            <div class="font-semibold text-purple-800">📊 Model (Data Structure)</div>
                                                            <pre class="text-xs mt-2 text-gray-800"><code>interface Note {
  id: string;
  title: string;
  content: string;
  tags: string[];
  createdAt: Date;
}</code></pre>
                                                        </div>
                                                        <div class="bg-white p-3 rounded border-l-2 border-purple-300">
                                                            <div class="font-semibold text-purple-800">🧠 ViewModel (State + Logic) - Zustand Store</div>
                                                            <pre class="text-xs mt-2 text-gray-800"><code>const useNoteEditorViewModel = create((set) => ({
  currentNote: null,
  isLoading: false,
  
  loadNote: async (id) => {
    set({ isLoading: true });
    const note = await NotesService.getById(id);
    set({ currentNote: note, isLoading: false });
  },
  
  saveNote: async (note) => {
    await NotesService.save(note);
    set({ currentNote: note });
  }
}));</code></pre>
                                                        </div>
                                                        <div class="bg-white p-3 rounded border-l-2 border-purple-300">
                                                            <div class="font-semibold text-purple-800">🎨 View (UI Component)</div>
                                                            <pre class="text-xs mt-2 text-gray-800"><code>function NoteEditor() {
  const { currentNote, loadNote, saveNote } = useNoteEditorViewModel();
  
  return (
    &lt;div&gt;
      &lt;input value={currentNote?.title} /&gt;
      &lt;textarea value={currentNote?.content} /&gt;
      &lt;button onClick={() => saveNote(currentNote)}&gt;Save&lt;/button&gt;
    &lt;/div&gt;
  );
}</code></pre>
                                                        </div>
                                                    </div>
                                                    <p class="text-gray-700 mt-3 text-sm">
                                                        ✅ View only handles UI rendering<br>
                                                        ✅ ViewModel handles all business logic and state<br>
                                                        ✅ Model is just the data structure<br>
                                                        ✅ Easy to test: Test ViewModel without rendering UI
                                                    </p>
                                                </div>
                                            </div>

                                            <!-- CRDT-Ready Data -->
                                            <div class="bg-white p-5 rounded-lg border-l-4 border-orange-500">
                                                <h5 class="text-lg font-bold text-orange-900 mb-3 flex items-center">
                                                    <span class="bg-orange-500 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3 text-sm">4</span>
                                                    CRDT-Ready Data (Conflict-free Replicated Data Types)
                                                </h5>
                                                <p class="text-gray-700 mb-3">
                                                    <strong>What it is:</strong> A data structure that can be edited on multiple devices simultaneously and merged without conflicts.
                                                </p>
                                                <p class="text-gray-700 mb-3">
                                                    <strong>Why we use it:</strong> Enables offline-first collaboration. Users can edit notes on different devices, even offline, and changes sync automatically when they reconnect.
                                                </p>
                                                <div class="bg-orange-50 p-4 rounded-lg">
                                                    <p class="font-semibold text-orange-900 mb-3">Example: Collaborative Note Editing</p>
                                                    
                                                    <div class="bg-white p-3 rounded mb-3">
                                                        <div class="font-semibold text-orange-800 mb-2">❌ Traditional Approach (Conflicts!)</div>
                                                        <div class="text-sm space-y-2">
                                                            <div class="flex items-start gap-2">
                                                                <span class="text-orange-600">👤 Alice (offline):</span>
                                                                <span>Edits note: "Buy milk" → "Buy milk and eggs"</span>
                                                            </div>
                                                            <div class="flex items-start gap-2">
                                                                <span class="text-orange-600">👤 Bob (offline):</span>
                                                                <span>Edits same note: "Buy milk" → "Buy milk and bread"</span>
                                                            </div>
                                                            <div class="flex items-start gap-2 text-red-600 font-semibold">
                                                                <span>⚠️ Conflict:</span>
                                                                <span>Which version wins? Manual resolution needed!</span>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="bg-white p-3 rounded">
                                                        <div class="font-semibold text-green-800 mb-2">✅ CRDT Approach (No Conflicts!)</div>
                                                        <div class="text-sm space-y-2">
                                                            <div class="flex items-start gap-2">
                                                                <span class="text-green-600">👤 Alice:</span>
                                                                <span>Inserts " and eggs" at position 9</span>
                                                            </div>
                                                            <div class="flex items-start gap-2">
                                                                <span class="text-green-600">👤 Bob:</span>
                                                                <span>Inserts " and bread" at position 9</span>
                                                            </div>
                                                            <div class="flex items-start gap-2 text-green-600 font-semibold">
                                                                <span>✅ Merged:</span>
                                                                <span>"Buy milk and eggs and bread"</span>
                                                            </div>
                                                            <p class="text-gray-600 text-xs mt-2">
                                                                Each operation has a unique ID and timestamp. CRDT algorithm automatically merges changes in a consistent way across all devices.
                                                            </p>
                                                        </div>
                                                    </div>

                                                    <div class="mt-3 bg-orange-100 p-3 rounded">
                                                        <p class="font-semibold text-orange-900 text-sm mb-2">CRDT Fields in Database:</p>
                                                        <pre class="text-xs text-gray-800"><code>CREATE TABLE notes (
  id TEXT PRIMARY KEY,
  title TEXT,
  content TEXT,
  
  -- CRDT fields
  vector_clock TEXT,      -- Tracks edit history
  site_id TEXT,           -- Device identifier
  last_modified INTEGER,  -- Timestamp
  deleted INTEGER         -- Soft delete flag
);</code></pre>
                                                        <p class="text-gray-700 mt-2 text-sm">
                                                            ✅ Works offline on multiple devices<br>
                                                            ✅ Syncs automatically when online<br>
                                                            ✅ No manual conflict resolution needed<br>
                                                            ✅ Google Docs-style real-time collaboration
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Summary -->
                                            <div class="bg-gradient-to-r from-blue-50 to-purple-50 p-5 rounded-lg border-2 border-indigo-200">
                                                <h5 class="text-lg font-bold text-indigo-900 mb-3">🎯 How They Work Together</h5>
                                                <div class="space-y-2 text-sm text-gray-800">
                                                    <div class="flex items-start gap-2">
                                                        <span class="font-semibold text-blue-600">Monorepo</span>
                                                        <span>→ Houses all domains and shared code in one place</span>
                                                    </div>
                                                    <div class="flex items-start gap-2">
                                                        <span class="font-semibold text-green-600">DDD</span>
                                                        <span>→ Each domain (Notes, Files, etc.) is self-contained</span>
                                                    </div>
                                                    <div class="flex items-start gap-2">
                                                        <span class="font-semibold text-purple-600">MVVM</span>
                                                        <span>→ Within each domain, separate Model, View, and ViewModel</span>
                                                    </div>
                                                    <div class="flex items-start gap-2">
                                                        <span class="font-semibold text-orange-600">CRDT</span>
                                                        <span>→ Data layer supports offline-first collaboration</span>
                                                    </div>
                                                </div>
                                                <div class="mt-4 p-3 bg-white rounded border border-indigo-300">
                                                    <p class="text-sm text-gray-700">
                                                        <strong>Result:</strong> A scalable, maintainable architecture where teams can work independently on different domains,
                                                        code is easy to test and understand, and users can collaborate in real-time even when offline.
                                                    </p>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Accordion 1: Monorepo Structure -->
                            <div class="mb-4 border border-gray-200 rounded-lg">
                                <div class="collapsible-header p-4 flex items-center justify-between cursor-pointer hover:bg-gray-50" onclick="toggleCollapsible(this)">
                                    <h4 class="text-lg font-semibold text-blue-900">1. Monorepo Structure (DDD + MVVM)</h4>
                                    <svg class="w-5 h-5 text-secondary transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                    </svg>
                                </div>
                                <div class="collapsible-content">
                                    <div class="p-4 bg-blue-50">
                                <div class="bg-gray-900 text-green-400 p-4 rounded-lg font-mono text-xs overflow-x-auto">
<pre>salina-local-first/
├── .github/
│   └── workflows/           # CI/CD pipelines
│       ├── test.yml
│       ├── build.yml
│       └── release.yml
├── packages/
│   ├── desktop/             # Electron + React Desktop App
│   │   ├── src/
│   │   │   ├── main/        # Electron main process
│   │   │   │   ├── index.ts
│   │   │   │   ├── ipc/     # IPC handlers
│   │   │   │   │   ├── database.ts
│   │   │   │   │   ├── files.ts
│   │   │   │   │   ├── transcription.ts
│   │   │   │   │   └── sync.ts
│   │   │   │   ├── services/
│   │   │   │   │   ├── DatabaseService.ts
│   │   │   │   │   ├── FileSystemService.ts
│   │   │   │   │   └── PythonBridgeService.ts
│   │   │   │   └── window/
│   │   │   │       └── WindowManager.ts
│   │   │   ├── preload/     # Preload scripts (context bridge)
│   │   │   │   └── index.ts
│   │   │   └── renderer/    # React app entry point
│   │   │       ├── index.html
│   │   │       ├── main.tsx
│   │   │       ├── App.tsx
│   │   │       ├── routes/
│   │   │       └── styles/
│   │   ├── forge.config.ts  # Electron Forge configuration
│   │   ├── vite.main.config.ts
│   │   ├── vite.preload.config.ts
│   │   ├── vite.renderer.config.ts
│   │   └── package.json
│   │
│   ├── shared/              # Shared utilities & types
│   │   ├── types/
│   │   │   ├── index.ts
│   │   │   ├── database.ts
│   │   │   ├── ipc.ts
│   │   │   └── models.ts
│   │   ├── utils/
│   │   │   ├── date.ts
│   │   │   ├── validation.ts
│   │   │   ├── crypto.ts
│   │   │   └── logger.ts
│   │   ├── constants/
│   │   │   ├── app.ts
│   │   │   ├── paths.ts
│   │   │   └── defaults.ts
│   │   ├── hooks/           # Shared React hooks
│   │   │   ├── useDebounce.ts
│   │   │   ├── useLocalStorage.ts
│   │   │   └── useIPC.ts
│   │   └── package.json
│   │
│   ├── ui/                  # Shared UI Component Library
│   │   ├── components/      # Shadcn/ui + Radix UI
│   │   │   ├── button/
│   │   │   ├── dialog/
│   │   │   ├── form/
│   │   │   ├── input/
│   │   │   └── index.ts
│   │   ├── styles/
│   │   │   └── globals.css  # Tailwind CSS
│   │   ├── .storybook/      # Storybook 9 config
│   │   │   ├── main.ts
│   │   │   └── preview.ts
│   │   └── package.json
│   │
│   ├── domains/             # DDD Bounded Contexts
│   │   ├── notes/
│   │   │   ├── models/      # Domain models (Plain objects)
│   │   │   │   ├── Note.ts
│   │   │   │   ├── NoteTag.ts
│   │   │   │   └── index.ts
│   │   │   ├── viewmodels/  # MVVM ViewModels (Zustand stores)
│   │   │   │   ├── useNotesViewModel.ts
│   │   │   │   └── useNoteEditorViewModel.ts
│   │   │   ├── views/       # React components
│   │   │   │   ├── NotesList.tsx
│   │   │   │   ├── NoteEditor.tsx
│   │   │   │   ├── NoteCard.tsx
│   │   │   │   └── index.ts
│   │   │   ├── services/    # Business logic
│   │   │   │   ├── NotesService.ts
│   │   │   │   └── NotesSyncService.ts
│   │   │   ├── repositories/ # Data access layer
│   │   │   │   ├── NotesRepository.ts
│   │   │   │   └── SQLiteNotesRepository.ts
│   │   │   └── package.json
│   │   │
│   │   ├── files/
│   │   │   ├── models/
│   │   │   │   ├── File.ts
│   │   │   │   ├── Folder.ts
│   │   │   │   └── FileMetadata.ts
│   │   │   ├── viewmodels/
│   │   │   │   ├── useFilesViewModel.ts
│   │   │   │   └── useFileUploadViewModel.ts
│   │   │   ├── views/
│   │   │   │   ├── FileExplorer.tsx
│   │   │   │   ├── FileUpload.tsx
│   │   │   │   └── FilePreview.tsx
│   │   │   ├── services/
│   │   │   │   ├── FilesService.ts
│   │   │   │   └── FileStorageService.ts
│   │   │   ├── repositories/
│   │   │   │   └── FilesRepository.ts
│   │   │   └── package.json
│   │   │
│   │   ├── transcriptions/
│   │   │   ├── models/
│   │   │   │   ├── Transcription.ts
│   │   │   │   ├── TranscriptionSegment.ts
│   │   │   │   └── TranscriptionJob.ts
│   │   │   ├── viewmodels/
│   │   │   │   ├── useTranscriptionsViewModel.ts
│   │   │   │   └── useTranscriptionPlayerViewModel.ts
│   │   │   ├── views/
│   │   │   │   ├── TranscriptionsList.tsx
│   │   │   │   ├── TranscriptionEditor.tsx
│   │   │   │   ├── TranscriptionPlayer.tsx
│   │   │   │   └── WaveformVisualizer.tsx
│   │   │   ├── services/
│   │   │   │   ├── TranscriptionService.ts
│   │   │   │   ├── FFmpegService.ts
│   │   │   │   └── WhisperService.ts
│   │   │   ├── repositories/
│   │   │   │   └── TranscriptionsRepository.ts
│   │   │   └── package.json
│   │   │
│   │   ├── search/
│   │   │   ├── models/
│   │   │   │   ├── SearchQuery.ts
│   │   │   │   ├── SearchResult.ts
│   │   │   │   └── SearchIndex.ts
│   │   │   ├── viewmodels/
│   │   │   │   ├── useSearchViewModel.ts
│   │   │   │   └── useChatViewModel.ts
│   │   │   ├── views/
│   │   │   │   ├── SearchBar.tsx
│   │   │   │   ├── SearchResults.tsx
│   │   │   │   └── ChatInterface.tsx
│   │   │   ├── services/
│   │   │   │   ├── SearchService.ts
│   │   │   │   ├── IndexingService.ts  # MiniSearch
│   │   │   │   └── ChatService.ts
│   │   │   ├── repositories/
│   │   │   │   └── SearchIndexRepository.ts
│   │   │   └── package.json
│   │   │
│   │   └── home/
│   │       ├── models/
│   │       │   └── DashboardCard.ts
│   │       ├── viewmodels/
│   │       │   └── useHomeViewModel.ts
│   │       ├── views/
│   │       │   ├── Dashboard.tsx
│   │       │   ├── QuickActions.tsx
│   │       │   └── RecentActivity.tsx
│   │       ├── services/
│   │       │   └── DashboardService.ts
│   │       └── package.json
│   │
│   └── infrastructure/      # Cross-cutting concerns
│       ├── database/
│       │   ├── index.ts
│       │   ├── schema.sql
│       │   ├── migrations/
│       │   │   ├── 001_initial.sql
│       │   │   ├── 002_add_crdt_fields.sql
│       │   │   └── index.ts
│       │   ├── SQLiteAdapter.ts
│       │   └── QueryBuilder.ts
│       │
│       ├── sync/            # CRDT sync engine
│       │   ├── CRDTEngine.ts
│       │   ├── VectorClock.ts
│       │   ├── ConflictResolver.ts
│       │   ├── SyncService.ts
│       │   └── WebRTCPeer.ts
│       │
│       ├── media/           # Media processing
│       │   ├── FFmpegService.ts
│       │   ├── AudioProcessor.ts
│       │   ├── VideoProcessor.ts
│       │   └── ThumbnailGenerator.ts
│       │
│       ├── ai/              # Local AI services
│       │   ├── WhisperBridge.ts      # Python bridge
│       │   ├── TransformersService.ts # Transformers.js
│       │   └── EmbeddingService.ts
│       │
│       ├── storage/
│       │   ├── FileSystemService.ts
│       │   ├── BlobStorage.ts
│       │   └── CacheService.ts
│       │
│       ├── python/          # Python runtime integration
│       │   ├── bridge.ts    # Node-Python bridge
│       │   ├── scripts/
│       │   │   ├── transcribe.py      # Faster Whisper
│       │   │   ├── translate.py
│       │   │   └── requirements.txt
│       │   └── runtime/     # Bundled Python runtime
│       │
│       ├── auth/
│       │   ├── AuthService.ts
│       │   ├── TokenManager.ts
│       │   └── SecurityService.ts
│       │
│       └── network/
│           ├── APIClient.ts
│           ├── WebSocketClient.ts
│           └── SyncQueue.ts
│
├── tests/
│   ├── unit/                # Vitest unit tests
│   │   └── **/*.test.ts
│   ├── integration/         # Integration tests
│   │   └── **/*.test.ts
│   └── e2e/                 # Playwright E2E tests
│       ├── playwright.config.ts
│       └── **/*.spec.ts
│
├── scripts/
│   ├── build.sh
│   ├── dev.sh
│   ├── test.sh
│   └── bundle-python.sh     # Bundle Python runtime
│
├── .eslintrc.js
├── .prettierrc
├── tsconfig.json            # Root TypeScript config
├── tsconfig.base.json       # Base config for packages
├── vitest.config.ts
├── package.json             # Root package.json (workspaces)
├── pnpm-workspace.yaml      # or npm/yarn workspaces
└── README.md</pre>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Accordion 2: SQLite Schema -->
                            <div class="mb-4 border border-gray-200 rounded-lg">
                                <div class="collapsible-header p-4 flex items-center justify-between cursor-pointer hover:bg-gray-50" onclick="toggleCollapsible(this)">
                                    <h4 class="text-lg font-semibold text-primary">2. SQLite Schema (CRDT-Ready)</h4>
                                    <svg class="w-5 h-5 text-secondary transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                    </svg>
                                </div>
                                <div class="collapsible-content">
                                    <div class="p-4 bg-light">
                                    <div class="bg-gray-900 text-green-400 p-4 rounded-lg font-mono text-xs overflow-x-auto">
<pre>-- Notes with CRDT metadata
CREATE TABLE notes (
  id TEXT PRIMARY KEY,
  title TEXT NOT NULL,
  content TEXT,
  tags TEXT, -- JSON array
  -- CRDT fields
  vector_clock TEXT, -- Lamport timestamp
  site_id TEXT,      -- Unique device ID
  version INTEGER DEFAULT 1,
  -- Sync fields
  sync_status TEXT DEFAULT 'pending',
  last_synced_at DATETIME,
  cloud_id TEXT,
  -- Audit fields
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- Transcriptions table (SQLite)
CREATE TABLE transcriptions (
  id TEXT PRIMARY KEY,
  file_id TEXT NOT NULL,
  file_path TEXT NOT NULL,
  original_filename TEXT,
  transcript TEXT,
  language TEXT DEFAULT 'en',
  duration REAL,
  status TEXT DEFAULT 'pending',
  faster_whisper_model TEXT DEFAULT 'base',
  device_type TEXT DEFAULT 'cpu', -- 'cpu' or 'cuda'
  created_at INTEGER NOT NULL,
  updated_at INTEGER NOT NULL,
  FOREIGN KEY (file_id) REFERENCES files(id)
);

-- Transcription segments table
CREATE TABLE transcription_segments (
  id TEXT PRIMARY KEY,
  transcription_id TEXT NOT NULL,
  segment_idx INTEGER NOT NULL,
  start_time REAL NOT NULL,
  end_time REAL NOT NULL,
  text TEXT NOT NULL,
  words TEXT, -- JSON array
  FOREIGN KEY (transcription_id) REFERENCES transcriptions(id)
);</pre>
                                    </div>
                                </div>
                                </div>
                            </div>

                            <!-- Accordion 3: Electron Forge Main Process -->
                            <div class="mb-4 border border-gray-200 rounded-lg">
                                <div class="collapsible-header p-4 flex items-center justify-between cursor-pointer hover:bg-gray-50" onclick="toggleCollapsible(this)">
                                    <h4 class="text-lg font-semibold text-accent">3. Electron Forge Main Process</h4>
                                    <svg class="w-5 h-5 text-secondary transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                    </svg>
                                </div>
                                <div class="collapsible-content">
                                    <div class="p-4 bg-light">
                                    <div class="bg-gray-900 text-green-400 p-4 rounded-lg font-mono text-xs overflow-x-auto">
<pre>// packages/desktop/src/main/index.ts
import { app, BrowserWindow, ipcMain } from 'electron';
import Database from 'better-sqlite3';
import * as path from 'path';
import { initDatabase } from '@salina/infrastructure/database';
import { setupIPC } from './ipc';
import { setupTranscriptionIPC } from './transcription-ipc';

let mainWindow: BrowserWindow | null = null;
let db: Database;

async function createWindow() {
  // Initialize SQLite database
  const dbPath = path.join(app.getPath('userData'), 'salina.db');
  db = new Database(dbPath);
  await initDatabase(db);
  
  mainWindow = new BrowserWindow({
    width: 1200,
    height: 800,
    webPreferences: {
      nodeIntegration: false,
      contextIsolation: true,
      preload: path.join(__dirname, 'preload.js')
    }
  });
  
  // Setup IPC handlers (file storage, transcription, etc.)
  setupIPC(db);
  setupTranscriptionIPC(); // Faster Whisper via Python
  
  // Load app
  if (MAIN_WINDOW_VITE_DEV_SERVER_URL) {
    mainWindow.loadURL(MAIN_WINDOW_VITE_DEV_SERVER_URL);
  } else {
    mainWindow.loadFile(
      path.join(__dirname, 
        `../renderer/${MAIN_WINDOW_VITE_NAME}/index.html`)
    );
  }
}</pre>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Accordion 4: MVVM ViewModel Example -->
                            <div class="mb-4 border border-gray-200 rounded-lg">
                                <div class="collapsible-header p-4 flex items-center justify-between cursor-pointer hover:bg-gray-50" onclick="toggleCollapsible(this)">
                                    <h4 class="text-lg font-semibold text-green-600">4. MVVM ViewModel Example</h4>
                                    <svg class="w-5 h-5 text-secondary transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                    </svg>
                                </div>
                                <div class="collapsible-content">
                                    <div class="p-4 bg-light">
                                    <div class="bg-gray-900 text-green-400 p-4 rounded-lg font-mono text-xs overflow-x-auto">
<pre>// packages/domains/notes/viewmodels/NotesViewModel.ts
import { create } from 'zustand';
import { NotesService } from '../services/NotesService';
import { Note } from '../models/Note';

interface NotesState {
  notes: Note[];
  isLoading: boolean;
  selectedNote: Note | null;
  
  // Actions
  fetchNotes: () => Promise&lt;void&gt;;
  createNote: (data: Partial&lt;Note&gt;) => Promise&lt;Note&gt;;
  updateNote: (id: string, data: Partial&lt;Note&gt;) => Promise&lt;void&gt;;
  deleteNote: (id: string) => Promise&lt;void&gt;;
  selectNote: (note: Note | null) => void;
}

export const useNotesViewModel = create&lt;NotesState&gt;((set, get) => ({
  notes: [],
  isLoading: false,
  selectedNote: null,
  
  fetchNotes: async () => {
    set({ isLoading: true });
    const service = new NotesService();
    const notes = await service.getAllNotes();
    set({ notes, isLoading: false });
  },
  
  createNote: async (data) => {
    const service = new NotesService();
    const note = await service.createNote(data);
    set((state) => ({ 
      notes: [...state.notes, note] 
    }));
    return note;
  },
  // ... other actions
}));</pre>
                                    </div>
                                </div>
                                </div>
                            </div>

                            <!-- Accordion 5: FFmpeg + Faster Whisper Integration -->
                            <div class="mb-4 border border-gray-200 rounded-lg">
                                <div class="collapsible-header p-4 flex items-center justify-between cursor-pointer hover:bg-gray-50" onclick="toggleCollapsible(this)">
                                    <h4 class="text-lg font-semibold text-purple-600">5. FFmpeg + Faster Whisper Integration (Electron)</h4>
                                    <svg class="w-5 h-5 text-secondary transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                    </svg>
                                </div>
                                <div class="collapsible-content">
                                    <div class="p-4 bg-light">
                                    <div class="bg-gray-900 text-green-400 p-4 rounded-lg font-mono text-xs overflow-x-auto">
<pre>// packages/infrastructure/media/TranscriptionService.ts
import { spawn } from 'child_process';
import * as path from 'path';
import * as fs from 'fs';
import { app } from 'electron';

export class TranscriptionService {
  private ffmpegPath: string;
  private pythonPath: string;
  private tempDir: string;
  
  constructor() {
    // FFmpeg native binary bundled with Electron
    const platform = process.platform;
    const ffmpegBinary = platform === 'win32' ? 'ffmpeg.exe' : 'ffmpeg';
    this.ffmpegPath = path.join(process.resourcesPath, 'bin', ffmpegBinary);
    
    // Python executable bundled with Electron
    const pythonBinary = platform === 'win32' ? 'python.exe' : 'python3';
    this.pythonPath = path.join(process.resourcesPath, 'python', pythonBinary);
    
    // Temp directory for processing
    this.tempDir = path.join(app.getPath('temp'), 'salina-transcriptions');
    if (!fs.existsSync(this.tempDir)) {
      fs.mkdirSync(this.tempDir, { recursive: true });
    }
  }
  
  async extractAudio(inputPath: string, outputPath: string): Promise&lt;void&gt; {
    return new Promise((resolve, reject) => {
      // Use native FFmpeg 8.0 binary
      const ffmpeg = spawn(this.ffmpegPath, [
        '-i', inputPath,
        '-ar', '16000',        // 16kHz sample rate
        '-ac', '1',            // Mono audio
        '-c:a', 'pcm_s16le',   // PCM encoding
        '-y',                  // Overwrite output
        outputPath
      ]);
      
      ffmpeg.stderr.on('data', (data) => {
        console.log(`FFmpeg: ${data}`);
      });
      
      ffmpeg.on('close', (code) => {
        if (code === 0) {
          resolve();
        } else {
          reject(new Error(`FFmpeg failed with code ${code}`));
        }
      });
    });
  }
  
  async transcribeAudio(filePath: string, options = {}): Promise&lt;any&gt; {
    // Extract audio using native FFmpeg 8.0
    const audioPath = path.join(this.tempDir, 'audio.wav');
    await this.extractAudio(filePath, audioPath);
    
    // Transcribe with Faster Whisper via Python bridge
    const scriptPath = path.join(__dirname, 'scripts', 'transcribe.py');
    return new Promise((resolve, reject) => {
      const python = spawn(this.pythonPath, [
        scriptPath,
        audioPath,
        '--model', options.model || 'base',
        '--device', options.device || 'cpu', // or 'cuda' for GPU
        '--language', options.language || 'auto',
        '--output_format', 'json'
      ]);
      
      let output = '';
      let errorOutput = '';
      
      python.stdout.on('data', (data) => {
        output += data.toString();
      });
      
      python.stderr.on('data', (data) => {
        errorOutput += data.toString();
      });
      
      python.on('close', (code) => {
        // Cleanup temp file
        if (fs.existsSync(audioPath)) {
          fs.unlinkSync(audioPath);
        }
        
        if (code === 0) {
          resolve(JSON.parse(output));
        } else {
          reject(new Error(`Transcription failed: ${errorOutput}`));
        }
      });
    });
  }
  
  async downloadYouTube(url: string, outputDir: string): Promise&lt;string&gt; {
    // Use yt-dlp native binary for YouTube downloads
    const ytdlpPath = path.join(process.resourcesPath, 'bin', 'yt-dlp');
    
    return new Promise((resolve, reject) => {
      const ytdlp = spawn(ytdlpPath, [
        '-f', 'bestaudio',
        '-o', path.join(outputDir, '%(title)s.%(ext)s'),
        '--print', 'after_move:filepath', // Print final file path
        url
      ]);
      
      let output = '';
      
      ytdlp.stdout.on('data', (data) => {
        output += data.toString();
      });
      
      ytdlp.on('close', (code) => {
        if (code === 0) {
          resolve(output.trim());
        } else {
          reject(new Error('YouTube download failed'));
        }
      });
    });
  }
}</pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Extensibility & Plugin Architecture Section -->
                        <div class="bg-white rounded-lg shadow-lg p-8 mb-8 card-hover">
                            <div class="mb-6">
                                <h3 class="text-2xl font-semibold">🔌 Extensibility & Plugin Architecture</h3>
                                <p class="text-secondary mt-2">Making Salina infinitely extensible through MCPs, Plugins, and Extensions</p>
                            </div>
                            
                            <!-- Introduction -->
                            <div class="bg-gradient-to-r from-teal-100 to-cyan-100 p-6 rounded-lg border-2 border-teal-300 mb-6">
                                <h4 class="text-xl font-bold text-teal-900 mb-3">🚀 Three Pillars of Extensibility</h4>
                                <p class="text-gray-800 mb-4">
                                    The Local-First Desktop Architecture is designed to be <strong>infinitely extensible</strong> through three powerful mechanisms:
                                </p>
                                <div class="grid md:grid-cols-3 gap-4">
                                    <div class="bg-white p-4 rounded-lg border-l-4 border-blue-500">
                                        <div class="font-bold text-blue-900 mb-2">🤖 MCPs</div>
                                        <div class="text-sm text-gray-700">Model Context Protocol for AI tool integrations (n8n, Google APIs, Slack, etc.)</div>
                                    </div>
                                    <div class="bg-white p-4 rounded-lg border-l-4 border-purple-500">
                                        <div class="font-bold text-purple-900 mb-2">🧩 Plugins</div>
                                        <div class="text-sm text-gray-700">Extend core functionality (AI writing assistant, grammar checker, etc.)</div>
                                    </div>
                                    <div class="bg-white p-4 rounded-lg border-l-4 border-green-500">
                                        <div class="font-bold text-green-900 mb-2">🔗 Extensions</div>
                                        <div class="text-sm text-gray-700">Third-party integrations (browser extensions, mobile apps, etc.)</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Accordion 1: MCP Integration -->
                            <div class="mb-4 border border-gray-200 rounded-lg">
                                <div class="collapsible-header p-4 flex items-center justify-between cursor-pointer hover:bg-gray-50" onclick="toggleCollapsible(this)">
                                    <h4 class="text-lg font-semibold text-blue-900">🤖 MCP (Model Context Protocol) Integration</h4>
                                    <svg class="w-5 h-5 text-secondary transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                    </svg>
                                </div>
                                <div class="collapsible-content">
                                    <div class="p-6 bg-blue-50">
                                        <div class="mb-4">
                                            <p class="text-gray-700 mb-3">
                                                <strong>What it is:</strong> A standardized protocol for connecting AI models with external tools and data sources. Think of it as "API for AI agents."
                                            </p>
                                            <p class="text-gray-700 mb-3">
                                                <strong>Why we use it:</strong> Allows AI chat/search to access Google APIs, Slack, Notion, automation workflows, and more—all through a unified interface.
                                            </p>
                                        </div>

                                        <div class="bg-white p-4 rounded-lg mb-4 border-l-4 border-blue-500">
                                            <p class="font-semibold text-blue-900 mb-3">Example: Google Calendar Integration via MCP</p>
                                            <div class="bg-blue-50 p-3 rounded mb-3">
                                                <div class="font-semibold text-blue-800 mb-2">📊 User Flow</div>
                                                <div class="text-sm space-y-1 font-mono text-gray-800">
                                                    <div>User: "Schedule a meeting with the team for tomorrow at 2pm"</div>
                                                    <div class="ml-4">↓</div>
                                                    <div>AI Chat (Search Module) → MCP Client</div>
                                                    <div class="ml-4">↓</div>
                                                    <div>MCP Server → Google Calendar API</div>
                                                    <div class="ml-4">↓</div>
                                                    <div>Event Created + Slack Notification Sent</div>
                                                    <div class="ml-4">↓</div>
                                                    <div>Confirmation → AI Chat → User</div>
                                                </div>
                                            </div>

                                            <div class="bg-gray-900 text-green-400 p-3 rounded">
                                                <div class="font-semibold text-green-300 mb-2">💻 Implementation</div>
                                                <pre class="text-xs overflow-x-auto"><code>// packages/infrastructure/mcp/MCPRegistry.ts
import { MCPClient } from '@modelcontextprotocol/sdk';

export class MCPRegistry {
  private clients: Map&lt;string, MCPClient&gt; = new Map();

  // Register MCP server
  async registerServer(config: MCPServerConfig) {
    const client = new MCPClient({
      name: config.name,
      version: config.version,
      transport: config.transport
    });
    await client.connect(config.command, config.args);
    this.clients.set(config.name, client);
  }

  // Call MCP tool from AI
  async callTool(serverName: string, toolName: string, args: any) {
    const client = this.clients.get(serverName);
    if (!client) throw new Error(\`Server \${serverName} not found\`);
    return await client.callTool(toolName, args);
  }
}</code></pre>
                                            </div>
                                        </div>

                                        <div class="bg-blue-100 p-4 rounded-lg">
                                            <p class="font-semibold text-blue-900 mb-3">🔧 Available MCP Integrations for Salina Users</p>
                                            <div class="grid md:grid-cols-2 gap-3 text-sm">
                                                <div class="bg-white p-3 rounded">
                                                    <strong>📝 Google Docs & Drive</strong>
                                                    <div class="text-gray-600">Sync notes, import/export documents</div>
                                                </div>
                                                <div class="bg-white p-3 rounded">
                                                    <strong>💬 Slack Integration</strong>
                                                    <div class="text-gray-600">Share transcriptions, send notes to channels</div>
                                                </div>
                                                <div class="bg-white p-3 rounded">
                                                    <strong>🗓️ Calendar (Google/Outlook)</strong>
                                                    <div class="text-gray-600">Create meeting notes, schedule from notes</div>
                                                </div>
                                                <div class="bg-white p-3 rounded">
                                                    <strong>📧 Email (Gmail/Outlook)</strong>
                                                    <div class="text-gray-600">Email transcriptions, send notes as attachments</div>
                                                </div>
                                                <div class="bg-white p-3 rounded">
                                                    <strong>✅ Task Management (Todoist/Asana)</strong>
                                                    <div class="text-gray-600">Convert notes to tasks, create action items</div>
                                                </div>
                                                <div class="bg-white p-3 rounded">
                                                    <strong>📊 Notion Database</strong>
                                                    <div class="text-gray-600">Sync notes with Notion pages</div>
                                                </div>
                                                <div class="bg-white p-3 rounded">
                                                    <strong>🔗 Zapier/Make Automation</strong>
                                                    <div class="text-gray-600">Trigger workflows when notes created</div>
                                                </div>
                                                <div class="bg-white p-3 rounded">
                                                    <strong>🎬 YouTube & Vimeo</strong>
                                                    <div class="text-gray-600">Import videos, export transcripts</div>
                                                </div>
                                            </div>
                                            
                                            <div class="mt-4 bg-blue-50 p-3 rounded">
                                                <p class="font-semibold text-blue-800 mb-2">💡 Real User Scenarios:</p>
                                                <div class="text-xs text-gray-700 space-y-1">
                                                    <div><strong>Sales Team:</strong> "Transcribe this sales call and email the summary to the client"</div>
                                                    <div><strong>Student:</strong> "Export my lecture notes to Google Docs for group project"</div>
                                                    <div><strong>Content Creator:</strong> "Upload YouTube video, transcribe it, and post transcript to Notion"</div>
                                                    <div><strong>Manager:</strong> "Create calendar event for next team meeting with meeting notes attached"</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Accordion 2: Plugin System -->
                            <div class="mb-4 border border-gray-200 rounded-lg">
                                <div class="collapsible-header p-4 flex items-center justify-between cursor-pointer hover:bg-gray-50" onclick="toggleCollapsible(this)">
                                    <h4 class="text-lg font-semibold text-purple-900">🧩 Plugin System Architecture</h4>
                                    <svg class="w-5 h-5 text-secondary transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                    </svg>
                                </div>
                                <div class="collapsible-content">
                                    <div class="p-6 bg-purple-50">
                                        <div class="mb-4">
                                            <p class="text-gray-700 mb-3">
                                                <strong>What it is:</strong> A modular system for extending Salina's core functionality through third-party or internal plugins.
                                            </p>
                                            <p class="text-gray-700 mb-3">
                                                <strong>Why we use it:</strong> Enables users and developers to add new features without modifying core code. Plugins can add AI models, file types, integrations, UI themes, and more.
                                            </p>
                                        </div>

                                        <div class="bg-purple-100 p-4 rounded-lg">
                                            <p class="font-semibold text-purple-900 mb-3">🎯 Real-World Plugin Examples for Salina</p>
                                            <div class="space-y-3 text-sm">
                                                <!-- Writing & Content Creation -->
                                                <div class="bg-white p-3 rounded">
                                                    <div class="font-bold text-purple-800 mb-2">✍️ Writing & Content Creation</div>
                                                    <div class="grid md:grid-cols-2 gap-2 text-gray-700">
                                                        <div>• <strong>AI Writing Assistant:</strong> Grammar, style, tone suggestions (like Grammarly)</div>
                                                        <div>• <strong>Content Templates:</strong> Meeting notes, blog post, research paper templates</div>
                                                        <div>• <strong>Word Counter & Analytics:</strong> Reading time, readability score, keyword density</div>
                                                        <div>• <strong>Citation Manager:</strong> APA, MLA, Chicago citation formatting</div>
                                                    </div>
                                                </div>

                                                <!-- Transcription Enhancements -->
                                                <div class="bg-white p-3 rounded">
                                                    <div class="font-bold text-purple-800 mb-2">🎥 Transcription Enhancements</div>
                                                    <div class="grid md:grid-cols-2 gap-2 text-gray-700">
                                                        <div>• <strong>Speaker Diarization:</strong> Auto-identify different speakers in conversations</div>
                                                        <div>• <strong>Auto-Summary Generator:</strong> AI-powered meeting summaries with action items</div>
                                                        <div>• <strong>Sentiment Analysis:</strong> Detect emotions and tone in transcriptions</div>
                                                        <div>• <strong>Keyword Extractor:</strong> Auto-tag transcriptions with key topics</div>
                                                    </div>
                                                </div>

                                                <!-- Productivity Tools -->
                                                <div class="bg-white p-3 rounded">
                                                    <div class="font-bold text-purple-800 mb-2">🚀 Productivity & Organization</div>
                                                    <div class="grid md:grid-cols-2 gap-2 text-gray-700">
                                                        <div>• <strong>Smart Tags & Categories:</strong> AI-powered auto-tagging for notes and files</div>
                                                        <div>• <strong>Kanban Board:</strong> Organize notes as task cards (Trello-style)</div>
                                                        <div>• <strong>Mind Map Generator:</strong> Visual brainstorming from text notes</div>
                                                        <div>• <strong>Daily Journal:</strong> Automatic daily note creation with prompts</div>
                                                    </div>
                                                </div>

                                                <!-- Collaboration -->
                                                <div class="bg-white p-3 rounded">
                                                    <div class="font-bold text-purple-800 mb-2">👥 Collaboration & Sharing</div>
                                                    <div class="grid md:grid-cols-2 gap-2 text-gray-700">
                                                        <div>• <strong>Team Workspaces:</strong> Shared note collections for teams</div>
                                                        <div>• <strong>Comment & Annotations:</strong> Collaborative editing with inline comments</div>
                                                        <div>• <strong>Version History:</strong> Track changes and restore previous versions</div>
                                                        <div>• <strong>Public Sharing:</strong> Create public links with password protection</div>
                                                    </div>
                                                </div>

                                                <!-- Media & Rich Content -->
                                                <div class="bg-white p-3 rounded">
                                                    <div class="font-bold text-purple-800 mb-2">🎨 Media & Rich Content</div>
                                                    <div class="grid md:grid-cols-2 gap-2 text-gray-700">
                                                        <div>• <strong>PDF Annotator:</strong> Highlight and comment directly on PDFs</div>
                                                        <div>• <strong>Drawing & Sketching:</strong> Handwritten notes and diagrams</div>
                                                        <div>• <strong>Math Equation Editor:</strong> LaTeX support for mathematical notation</div>
                                                        <div>• <strong>Mermaid Diagrams:</strong> Flowcharts, sequence diagrams from text</div>
                                                    </div>
                                                </div>

                                                <!-- Export & Integration -->
                                                <div class="bg-white p-3 rounded">
                                                    <div class="font-bold text-purple-800 mb-2">📤 Export & Integration</div>
                                                    <div class="grid md:grid-cols-2 gap-2 text-gray-700">
                                                        <div>• <strong>Multi-Format Export:</strong> PDF, DOCX, HTML, LaTeX, Obsidian</div>
                                                        <div>• <strong>Cloud Backup:</strong> Auto-backup to Dropbox, OneDrive, Google Drive</div>
                                                        <div>• <strong>E-book Generator:</strong> Convert notes to EPUB/MOBI formats</div>
                                                        <div>• <strong>Print Templates:</strong> Professional formatting for printed documents</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Accordion 3: Extensions Framework -->
                            <div class="mb-4 border border-gray-200 rounded-lg">
                                <div class="collapsible-header p-4 flex items-center justify-between cursor-pointer hover:bg-gray-50" onclick="toggleCollapsible(this)">
                                    <h4 class="text-lg font-semibold text-green-900">🔗 Extension Framework</h4>
                                    <svg class="w-5 h-5 text-secondary transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                    </svg>
                                </div>
                                <div class="collapsible-content">
                                    <div class="p-6 bg-green-50">
                                        <div class="mb-4">
                                            <p class="text-gray-700 mb-3">
                                                <strong>What it is:</strong> Browser-like extension system that runs in sandboxed environments with limited permissions.
                                            </p>
                                            <p class="text-gray-700 mb-3">
                                                <strong>Why we use it:</strong> Provides a secure, isolated way for third parties to extend Salina without risking security or stability.
                                            </p>
                                        </div>

                                        <div class="bg-green-100 p-4 rounded-lg">
                                            <p class="font-semibold text-green-900 mb-3">🌟 Real-World Extension Examples</p>
                                            <div class="space-y-3 text-sm">
                                                <!-- Browser Extensions -->
                                                <div class="bg-white p-3 rounded">
                                                    <div class="font-bold text-green-800 mb-2">🌐 Browser Extensions</div>
                                                    <div class="space-y-2 text-gray-700">
                                                        <div>
                                                            <strong>• Web Clipper (Chrome/Firefox/Edge)</strong>
                                                            <div class="text-xs ml-4 text-gray-600">Save articles, tweets, web pages directly to Salina with one click</div>
                                                        </div>
                                                        <div>
                                                            <strong>• YouTube Transcription Button</strong>
                                                            <div class="text-xs ml-4 text-gray-600">Add "Send to Salina" button on YouTube videos for instant transcription</div>
                                                        </div>
                                                        <div>
                                                            <strong>• Gmail Note Creator</strong>
                                                            <div class="text-xs ml-4 text-gray-600">Convert emails to notes, attach files from email to Salina</div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- Mobile Companion -->
                                                <div class="bg-white p-3 rounded">
                                                    <div class="font-bold text-green-800 mb-2">📱 Mobile & Cross-Platform</div>
                                                    <div class="space-y-2 text-gray-700">
                                                        <div>
                                                            <strong>• iOS/Android Companion App</strong>
                                                            <div class="text-xs ml-4 text-gray-600">Quick capture notes, voice memos, photos on mobile, sync to desktop</div>
                                                        </div>
                                                        <div>
                                                            <strong>• Apple Watch Quick Notes</strong>
                                                            <div class="text-xs ml-4 text-gray-600">Voice-to-text note capture from your wrist</div>
                                                        </div>
                                                        <div>
                                                            <strong>• iOS Share Extension</strong>
                                                            <div class="text-xs ml-4 text-gray-600">Share from any iOS app directly to Salina</div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- Desktop Enhancements -->
                                                <div class="bg-white p-3 rounded">
                                                    <div class="font-bold text-green-800 mb-2">💻 Desktop Enhancements</div>
                                                    <div class="space-y-2 text-gray-700">
                                                        <div>
                                                            <strong>• System Tray Quick Capture</strong>
                                                            <div class="text-xs ml-4 text-gray-600">Global hotkey (Ctrl+Shift+N) to create note from anywhere</div>
                                                        </div>
                                                        <div>
                                                            <strong>• Screen Recording Extension</strong>
                                                            <div class="text-xs ml-4 text-gray-600">Record screen + auto-transcribe narration, save to Salina</div>
                                                        </div>
                                                        <div>
                                                            <strong>• OCR Screenshot Tool</strong>
                                                            <div class="text-xs ml-4 text-gray-600">Screenshot → extract text → create note (instant OCR)</div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- Third-Party Integrations -->
                                                <div class="bg-white p-3 rounded">
                                                    <div class="font-bold text-green-800 mb-2">🔗 Third-Party Service Extensions</div>
                                                    <div class="space-y-2 text-gray-700">
                                                        <div>
                                                            <strong>• Zoom Meeting Recorder</strong>
                                                            <div class="text-xs ml-4 text-gray-600">Auto-capture Zoom meetings, transcribe, create searchable notes</div>
                                                        </div>
                                                        <div>
                                                            <strong>• Spotify Podcast Clipper</strong>
                                                            <div class="text-xs ml-4 text-gray-600">Save podcast timestamps with notes for later transcription</div>
                                                        </div>
                                                        <div>
                                                            <strong>• GitHub Integration</strong>
                                                            <div class="text-xs ml-4 text-gray-600">Link code snippets to notes, create technical documentation</div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- Use Case Examples -->
                                                <div class="bg-green-50 p-3 rounded border border-green-200">
                                                    <p class="font-semibold text-green-800 mb-2">💡 Real User Workflows:</p>
                                                    <div class="text-xs text-gray-700 space-y-1">
                                                        <div>📝 <strong>Researcher:</strong> Web clipper → Save 20 research articles → AI summarize → Create literature review note</div>
                                                        <div>🎓 <strong>Student:</strong> Record lecture on phone → Auto-transcribe → Sync to desktop → AI generate study notes</div>
                                                        <div>💼 <strong>Professional:</strong> Join Zoom meeting → Auto-record & transcribe → Extract action items → Email to team</div>
                                                        <div>✍️ <strong>Writer:</strong> Quick capture ideas on mobile → Expand on desktop → Grammar check → Export to blog</div>
                                                        <div>👨‍💼 <strong>Manager:</strong> Screenshot whiteboard → OCR text → Create project plan note → Share with team workspace</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Summary -->
                            <div class="bg-gradient-to-r from-teal-50 to-cyan-50 p-5 rounded-lg border-2 border-teal-200 mt-4">
                                <h4 class="text-lg font-bold text-teal-900 mb-3">🎯 Extensibility Benefits</h4>
                                <div class="grid md:grid-cols-2 gap-4 text-sm text-gray-800">
                                    <div>
                                        <div class="font-semibold text-teal-800 mb-2">For Users:</div>
                                        <ul class="space-y-1">
                                            <li>✅ Customize Salina to exact needs</li>
                                            <li>✅ Choose from marketplace or build own</li>
                                            <li>✅ Extend without waiting for official features</li>
                                            <li>✅ Community-driven innovation</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <div class="font-semibold text-teal-800 mb-2">For Platform:</div>
                                        <ul class="space-y-1">
                                            <li>✅ Faster feature development</li>
                                            <li>✅ Community contributions</li>
                                            <li>✅ Competitive advantage</li>
                                            <li>✅ Ecosystem growth</li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="mt-4 p-3 bg-white rounded border border-teal-300">
                                    <p class="text-sm text-gray-700">
                                        <strong>Vision:</strong> Create an ecosystem where Salina becomes a <em>platform</em>, not just an app—empowering developers and users to build the exact tools they need while maintaining security, performance, and user experience.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Recommendations -->
                        <div id="recommendations" class="bg-white rounded-lg shadow-lg p-8 card-hover">
                            <div class="mb-6">
                                <h3 class="text-2xl font-semibold">Strategic Recommendations</h3>
                            </div>
                            <div class="grid md:grid-cols-2 gap-8">
                                <div>
                                    <h4 class="text-lg font-semibold mb-4 text-primary">Phase 1 Actions (Weeks 1-3)</h4>
                                    <div class="space-y-4">
                                        <div class="p-4 border-l-4 border-primary bg-light">
                                            <div class="font-semibold mb-2">Monorepo Setup</div>
                                            <div class="text-sm text-secondary">Initialize monorepo with Electron Forge, configure workspaces, set up shared packages following DDD structure</div>
                                        </div>
                                        <div class="p-4 border-l-4 border-primary bg-light">
                                            <div class="font-semibold mb-2">React 19 Migration</div>
                                            <div class="text-sm text-secondary">Upgrade from React 18.2 to React 19 stable, test all existing components, update dependencies</div>
                                        </div>
                                        <div class="p-4 border-l-4 border-primary bg-light">
                                            <div class="font-semibold mb-2">SQLite + CRDT Setup</div>
                                            <div class="text-sm text-secondary">Initialize SQLite database with CRDT-ready schema, implement vector clocks for conflict resolution</div>
                                        </div>
                                        <div class="p-4 border-l-4 border-primary bg-light">
                                            <div class="font-semibold mb-2">Storybook 9 Integration</div>
                                            <div class="text-sm text-secondary">Set up Storybook 9 for component development, create stories for existing Shadcn/ui components</div>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <h4 class="text-lg font-semibold mb-4 text-green-600">Phase 2-4 Goals (Weeks 4-12)</h4>
                                    <div class="space-y-4">
                                        <div class="p-4 border-l-4 border-green-600 bg-light">
                                            <div class="font-semibold mb-2">MVVM Architecture</div>
                                            <div class="text-sm text-secondary">Refactor components to MVVM pattern with Zustand ViewModels, separate business logic from UI</div>
                                        </div>
                                        <div class="p-4 border-l-4 border-green-600 bg-light">
                                            <div class="font-semibold mb-2">FFmpeg 8.0 + Faster Whisper</div>
                                            <div class="text-sm text-secondary">Integrate FFmpeg 8.0 for media processing, implement Faster Whisper via Python bridge for local AI transcription (4x faster than standard Whisper)</div>
                                        </div>
                                        <div class="p-4 border-l-4 border-green-600 bg-light">
                                            <div class="font-semibold mb-2">yt-dlp Integration</div>
                                            <div class="text-sm text-secondary">Add YouTube download capability with yt-dlp, support direct URL transcription workflow</div>
                                        </div>
                                        <div class="p-4 border-l-4 border-green-600 bg-light">
                                            <div class="font-semibold mb-2">Testing & CI/CD</div>
                                            <div class="text-sm text-secondary">Expand Vitest unit tests, implement Playwright E2E tests, set up automated deployment pipeline</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Tech Stack Summary -->
                            <div class="mt-8 bg-gradient-to-r from-purple-50 to-pink-50 border-2 border-purple-200 p-6 rounded-lg">
                                <h4 class="text-lg font-semibold mb-4 text-purple-900">📋 Complete Tech Stack Summary</h4>
                                <div class="grid md:grid-cols-3 gap-4 text-sm">
                                    <div>
                                        <strong class="text-purple-900">Core:</strong>
                                        <ul class="text-purple-800 mt-2 space-y-1">
                                            <li>• Electron.js + Electron Forge</li>
                                            <li>• React 19 (stable)</li>
                                            <li>• TypeScript 5.0+</li>
                                            <li>• Vite 5.4.6</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <strong class="text-purple-900">Architecture:</strong>
                                        <ul class="text-purple-800 mt-2 space-y-1">
                                            <li>• Monorepo Structure</li>
                                            <li>• DDD (Domain-Driven Design)</li>
                                            <li>• MVVM Pattern</li>
                                            <li>• CRDT-Ready Data</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <strong class="text-purple-900">Media & AI:</strong>
                                        <ul class="text-purple-800 mt-2 space-y-1">
                                            <li>• FFmpeg 8.0 (Native Binary)</li>
                                            <li>• Faster Whisper (Python bridge)</li>
                                            <li>• yt-dlp YouTube Downloads</li>
                                            <li>• Local AI Translation (Transformers.js)</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <strong class="text-purple-900">Data & Storage:</strong>
                                        <ul class="text-purple-800 mt-2 space-y-1">
                                            <li>• SQLite Primary DB (better-sqlite3)</li>
                                            <li>• File System for binary storage</li>
                                            <li>• Zustand State Management</li>
                                            <li>• React Query v5</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <strong class="text-purple-900">UI & Components:</strong>
                                        <ul class="text-purple-800 mt-2 space-y-1">
                                            <li>• Storybook 9 (stable)</li>
                                            <li>• Shadcn/ui + Radix UI</li>
                                            <li>• Tailwind CSS</li>
                                            <li>• React Hook Form</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <strong class="text-purple-900">Testing & Quality:</strong>
                                        <ul class="text-purple-800 mt-2 space-y-1">
                                            <li>• Vitest Unit Testing</li>
                                            <li>• Playwright E2E</li>
                                            <li>• ESLint + Prettier</li>
                                            <li>• TypeScript Strict Mode</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Footer -->
            <footer class="bg-dark text-white py-12">
                <div class="container mx-auto px-6">
                    <div class="max-w-4xl mx-auto text-center">
                        <h3 class="text-2xl font-bold mb-4">Architecture Analysis Complete</h3>
                        <p class="text-gray-300 mb-8">
                            This comprehensive analysis provides a roadmap for transforming the Salina platform 
                            from a micro-frontend architecture to a local-first desktop application.
                        </p>
                        <div class="flex flex-col sm:flex-row gap-4 justify-center">
                            <button onclick="window.print()" class="bg-white text-dark px-6 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-colors">
                                Print Documentation
                            </button>
                            <button onclick="scrollToSection('executive-summary')" class="border border-white text-white px-6 py-3 rounded-lg font-semibold hover:bg-white hover:text-dark transition-colors">
                                Back to Top
                            </button>
                        </div>
                    </div>
                </div>
            </footer>
        </main>
    </div>

    <div class="tooltip" id="tooltip"></div>

    <script>
        // Initialize theme
        let currentTheme = localStorage.getItem('theme') || 'light';
        if (currentTheme === 'dark') {
            document.documentElement.classList.add('dark');
        }

        function toggleCollapsible(header) {
            const content = header.nextElementSibling;
            const arrow = header.querySelector('svg');
            
            content.classList.toggle('expanded');
            arrow.style.transform = content.classList.contains('expanded') ? 'rotate(180deg)' : 'rotate(0deg)';
        }

        function showCommunicationDetail(type) {
            const details = {
                'state-sharing': {
                    title: 'State Sharing',
                    content: 'Zustand stores provide a centralized state management system that allows components across different micro-frontends to share and react to global state changes. This includes user authentication, theme preferences, and application-wide settings.',
                    color: '#1e40af',
                    icon: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>'
                },
                'event-system': {
                    title: 'Event System',
                    content: 'CustomEvent API enables decoupled communication between modules. Events can be dispatched and listened to without tight coupling, allowing for flexible inter-module communication patterns.',
                    color: '#3b82f6',
                    icon: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 4V2a1 1 0 011-1h8a1 1 0 011 1v2m0 0V1a1 1 0 011-1h2a1 1 0 011 1v18a1 1 0 01-1 1H4a1 1 0 01-1-1V4a1 1 0 011-1h2a1 1 0 011 1v2"></path>'
                },
                'oauth-flow': {
                    title: 'OAuth Flow',
                    content: 'Cross-window communication using postMessage API handles OAuth authentication flows that typically involve popup windows, ensuring secure token passing between windows.',
                    color: '#10b981',
                    icon: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"></path>'
                },
                'routing': {
                    title: 'Routing',
                    content: 'URL-based communication allows modules to pass data and navigate between different parts of the application through well-defined URL patterns and parameters.',
                    color: '#8b5cf6',
                    icon: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path>'
                }
            };
            
            const detail = details[type];
            if (!detail) return;
            
            // Update modal content
            document.getElementById('communication-modal-title').textContent = detail.title;
            document.getElementById('communication-modal-content').textContent = detail.content;
            
            // Update icon
            const iconContainer = document.getElementById('communication-modal-icon');
            iconContainer.style.backgroundColor = detail.color;
            iconContainer.innerHTML = `<svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">${detail.icon}</svg>`;
            
            // Show modal
            document.getElementById('communication-modal').classList.remove('hidden');
        }

        function closeCommunicationModal() {
            document.getElementById('communication-modal').classList.add('hidden');
        }

        // Mobile menu toggle
        const sidebar = document.getElementById('sidebar');
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const closeSidebar = document.getElementById('close-sidebar');

        if (mobileMenuBtn && sidebar) {
        mobileMenuBtn.addEventListener('click', () => {
            sidebar.classList.remove('-translate-x-full');
        });
        }

        if (closeSidebar && sidebar) {
        closeSidebar.addEventListener('click', () => {
            sidebar.classList.add('-translate-x-full');
        });
        }

        // Search functionality
        function toggleSearch() {
            const modal = document.getElementById('search-modal');
            modal.classList.toggle('hidden');
            if (!modal.classList.contains('hidden')) {
                document.getElementById('search-input').focus();
            }
        }

        const searchToggle = document.getElementById('search-toggle');
        if (searchToggle) {
            searchToggle.addEventListener('click', toggleSearch);
        }

        // Search implementation
        const searchContent = [
            { title: 'Executive Summary', content: 'Current MFE vs Local-First overview', section: 'executive-summary' },
            { title: 'Architecture Overview', content: 'Micro frontend system components', section: 'current-architecture' },
            { title: 'Technology Stack', content: 'React, TypeScript, Vite, Zustand', section: 'tech-stack' },
            { title: 'Strengths & Limitations', content: 'Analysis of current approach', section: 'strengths-limitations' },
            { title: 'Communication Patterns', content: 'Inter-module communication methods', section: 'communication-patterns' },
            { title: 'Architecture Comparison', content: 'MFE vs Local-First comparison', section: 'architecture-comparison' },
            { title: 'Migration Timeline', content: 'Phased migration strategy', section: 'migration-timeline' },
            { title: 'Technical Architecture', content: 'Desktop app technical specs', section: 'technical-architecture' },
            { title: 'Recommendations', content: 'Strategic recommendations', section: 'recommendations' }
        ];

        document.getElementById('search-input').addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase();
            const results = searchContent.filter(item => 
                item.title.toLowerCase().includes(query) || 
                item.content.toLowerCase().includes(query)
            );

            const resultsContainer = document.getElementById('search-results');
            resultsContainer.innerHTML = results.map(result => `
                <div class="p-3 hover:bg-light cursor-pointer rounded" onclick="scrollToSection('${result.section}'); toggleSearch();">
                    <div class="font-semibold">${result.title}</div>
                    <div class="text-sm text-secondary">${result.content}</div>
                </div>
            `).join('') || '<div class="p-3 text-secondary">No results found</div>';
        });

        // Smooth scrolling
        function scrollToSection(sectionId) {
            const element = document.getElementById(sectionId);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // Progress tracking
        function updateProgress() {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            document.getElementById('progress-bar').style.width = scrolled + '%';
            document.getElementById('progress-percentage').textContent = Math.round(scrolled) + '%';
        }

        window.addEventListener('scroll', updateProgress);

        // Navigation highlighting
        function highlightNavigation() {
            const sections = document.querySelectorAll('section[id]');
            const navLinks = document.querySelectorAll('.nav-link');

            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                if (window.pageYOffset >= sectionTop) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('bg-accent', 'text-white');
                if (link.getAttribute('href') === '#' + current) {
                    link.classList.add('bg-accent', 'text-white');
                }
            });
        }

        window.addEventListener('scroll', highlightNavigation);

        // Initialize interactive charts
        function initCharts() {
            console.log('Initializing charts...');
            console.log('Chart available:', typeof Chart !== 'undefined');
            console.log('d3 available:', typeof d3 !== 'undefined');
            
            // Check if Chart.js is loaded
            if (typeof Chart === 'undefined') {
                console.error('Chart.js not loaded');
                return false;
            }
            
            console.log('Chart.js loaded successfully');

            // Tech Stack Chart
            const techStackCtx = document.getElementById('techStackChart');
            if (!techStackCtx) {
                console.error('Tech Stack Chart canvas not found');
            } else {
                console.log('Found techStackChart canvas');
                const ctx = techStackCtx.getContext('2d');
                if (ctx) {
                    console.log('Creating Tech Stack Chart...');
                    try {
                        new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['React 18.2.0', 'TypeScript', 'Vite 5.4.6', 'Zustand 4.4.6', 'Tailwind CSS', 'Radix UI'],
                        datasets: [{
                            data: [100, 100, 100, 100, 100, 100],
                            backgroundColor: [
                                '#3b82f6',
                                '#10b981',
                                '#8b5cf6',
                                '#f59e0b',
                                '#ef4444',
                                '#06b6d4'
                            ],
                            borderWidth: 2,
                            borderColor: '#ffffff'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 20,
                                    usePointStyle: true
                                }
                            }
                        }
                    }
                });
                        console.log('Tech Stack Chart created successfully');
                    } catch (error) {
                        console.error('Error creating Tech Stack Chart:', error);
                    }
                } else {
                    console.error('Could not get 2D context for techStackChart');
                }
            }

            // Performance Chart
            const performanceCtx = document.getElementById('performanceChart');
            if (!performanceCtx) {
                console.error('Performance Chart canvas not found');
            } else {
                console.log('Found performanceChart canvas');
                const ctx = performanceCtx.getContext('2d');
                if (ctx) {
                    console.log('Creating Performance Chart...');
                    try {
                        new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Initial Load', 'Offline Access', 'Data Privacy', 'Performance', 'Complexity'],
                        datasets: [
                            {
                                label: 'Current MFE Architecture',
                                data: [2, 1, 2, 3, 1],
                                backgroundColor: '#ef4444',
                                borderColor: '#dc2626',
                                borderWidth: 1
                            },
                            {
                                label: 'Proposed Local-First Desktop',
                                data: [9, 10, 10, 8, 7],
                                backgroundColor: '#10b981',
                                borderColor: '#059669',
                                borderWidth: 1
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 10,
                                ticks: {
                                    callback: function(value) {
                                        return value + '/10';
                                    }
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'top'
                            }
                        }
                    }
                });
                        console.log('Performance Chart created successfully');
                    } catch (error) {
                        console.error('Error creating Performance Chart:', error);
                    }
                } else {
                    console.error('Could not get 2D context for performanceChart');
                }
            }

            // Architecture Diagram
            initArchitectureDiagram();
            
            return true;
        }

        function initArchitectureDiagram() {
            console.log('Initializing architecture diagram...');
            const diagramContainer = document.getElementById('architecture-diagram');
            
            if (!diagramContainer) {
                console.error('Architecture diagram container not found');
                return false;
            }
            
            if (typeof d3 === 'undefined') {
                console.error('d3.js not loaded');
                return false;
            }
            
            console.log('d3.js loaded, creating diagram...');
            
            // Clear any existing content
            diagramContainer.innerHTML = '';
            
                const width = 300;
                const height = 280;

            try {
                const svg = d3.select('#architecture-diagram')
                    .append('svg')
                    .attr('width', width)
                    .attr('height', height)
                    .style('display', 'block');

                // Define nodes
                const nodes = [
                    { id: 'shell', x: width/2, y: 40, r: 25, color: '#1e40af', label: 'Shell' },
                    { id: 'home', x: width/4, y: 120, r: 20, color: '#3b82f6', label: 'Home' },
                    { id: 'search', x: 3*width/4, y: 120, r: 20, color: '#10b981', label: 'Search' },
                    { id: 'notes', x: width/4, y: 200, r: 20, color: '#f59e0b', label: 'Notes' },
                    { id: 'files', x: width/2, y: 200, r: 20, color: '#ef4444', label: 'Files' },
                    { id: 'transcriptions', x: 3*width/4, y: 200, r: 20, color: '#8b5cf6', label: 'Trans' }
                ];

                // Define links
                const links = [
                    { source: 'shell', target: 'home' },
                    { source: 'shell', target: 'search' },
                    { source: 'shell', target: 'notes' },
                    { source: 'shell', target: 'files' },
                    { source: 'shell', target: 'transcriptions' }
                ];

                // Add links
                svg.selectAll('.link')
                    .data(links)
                    .enter().append('line')
                    .attr('class', 'link')
                    .attr('x1', d => nodes.find(n => n.id === d.source).x)
                    .attr('y1', d => nodes.find(n => n.id === d.source).y)
                    .attr('x2', d => nodes.find(n => n.id === d.target).x)
                    .attr('y2', d => nodes.find(n => n.id === d.target).y)
                    .attr('stroke', '#d1d5db')
                    .attr('stroke-width', 2);

                // Add nodes
                const nodeGroups = svg.selectAll('.node')
                    .data(nodes)
                    .enter().append('g')
                    .attr('class', 'node')
                    .attr('transform', d => `translate(${d.x}, ${d.y})`)
                    .style('cursor', 'pointer');

                nodeGroups.append('circle')
                    .attr('r', d => d.r)
                    .attr('fill', d => d.color)
                    .attr('stroke', '#ffffff')
                    .attr('stroke-width', 3)
                    .style('transition', 'all 0.3s ease')
                    .on('mouseover', function(event, d) {
                        d3.select(this).attr('r', d.r * 1.1);
                        showTooltip(event, d.label);
                    })
                    .on('mouseout', function(event, d) {
                        d3.select(this).attr('r', d.r);
                        hideTooltip();
                    });

                nodeGroups.append('text')
                    .attr('text-anchor', 'middle')
                    .attr('dy', '0.35em')
                    .attr('fill', 'white')
                    .attr('font-size', '10px')
                    .attr('font-weight', 'bold')
                    .text(d => d.label);
                
                console.log('Architecture diagram created successfully');
                return true;
            } catch (error) {
                console.error('Error creating architecture diagram:', error);
                return false;
            }
        }

        function showTooltip(event, text) {
            const tooltip = document.getElementById('tooltip');
            if (!tooltip) {
                console.warn('Tooltip element not found');
                return;
            }
            tooltip.textContent = text;
            tooltip.classList.add('show');
            tooltip.style.left = (event.pageX + 10) + 'px';
            tooltip.style.top = (event.pageY - 10) + 'px';
        }

        function hideTooltip() {
            const tooltip = document.getElementById('tooltip');
            if (tooltip) {
            tooltip.classList.remove('show');
            }
        }
        
        // Expose manual initialization function for debugging
        window.manualInitCharts = function() {
            console.log('Manual chart initialization triggered');
            chartsInitialized = false;
            initializeApp();
        };

        // Close panels when clicking outside
        document.addEventListener('click', (e) => {
            const sidebar = document.getElementById('sidebar');
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            if (sidebar && mobileMenuBtn && window.innerWidth < 1024) {
                if (!sidebar.contains(e.target) && !mobileMenuBtn.contains(e.target)) {
                    sidebar.classList.add('-translate-x-full');
                }
            }
        });

        // Close communication modal when clicking outside
        const communicationModal = document.getElementById('communication-modal');
        if (communicationModal) {
            communicationModal.addEventListener('click', (e) => {
            if (e.target.id === 'communication-modal' || e.target.classList.contains('bg-black')) {
                closeCommunicationModal();
            }
        });
        }

        // Initialize
        let chartsInitialized = false;
        
        function initializeApp() {
            try {
            updateProgress();
            highlightNavigation();
            } catch (error) {
                console.warn('Error in app initialization:', error);
            }
            
            // Try to initialize charts with retry logic (independent of other initialization)
            let retryCount = 0;
            const maxRetries = 20;
            
            const tryInitCharts = () => {
                if (chartsInitialized) return;
                
                if (typeof Chart !== 'undefined' && typeof d3 !== 'undefined') {
                    console.log('Libraries loaded, initializing charts...');
                    try {
                        if (initCharts()) {
                            chartsInitialized = true;
                            console.log('Charts initialized successfully');
                        }
                    } catch (error) {
                        console.error('Error initializing charts:', error);
                    }
                } else {
                    retryCount++;
                    if (retryCount < maxRetries) {
                        console.log(`Waiting for libraries... (attempt ${retryCount}/${maxRetries})`);
                        setTimeout(tryInitCharts, 200);
                    } else {
                        console.error('Failed to load libraries after maximum retries');
                        console.log('Chart available:', typeof Chart !== 'undefined');
                        console.log('d3 available:', typeof d3 !== 'undefined');
                    }
                }
            };
            
            // Start initialization
            setTimeout(tryInitCharts, 100);
        }
        
        // Use both DOMContentLoaded and window.onload for maximum compatibility
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                try {
                    initializeApp();
                } catch (error) {
                    console.error('Error in DOMContentLoaded handler:', error);
                }
            });
        } else {
            try {
                initializeApp();
            } catch (error) {
                console.error('Error in immediate initialization:', error);
            }
        }
        
        window.addEventListener('load', () => {
            if (!chartsInitialized) {
                console.log('Window loaded, retrying chart initialization...');
                setTimeout(() => {
                    if (typeof Chart !== 'undefined' && typeof d3 !== 'undefined') {
                        try {
                            initCharts();
                        } catch (error) {
                            console.error('Error in window.load chart initialization:', error);
                        }
                    }
                }, 500);
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            // Ctrl/Cmd + K for search
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                toggleSearch();
            }
            // Escape to close modals
            if (e.key === 'Escape') {
                const searchModal = document.getElementById('search-modal');
                const communicationModal = document.getElementById('communication-modal');
                
                if (!searchModal.classList.contains('hidden')) {
                    toggleSearch();
                }
                if (!communicationModal.classList.contains('hidden')) {
                    closeCommunicationModal();
                }
                if (!sidebar.classList.contains('-translate-x-full') && window.innerWidth < 1024) {
                    sidebar.classList.add('-translate-x-full');
                }
            }
        });
    </script>
</body>
</html>